2025-02-13 19:07:44,151 - INFO - 2494785685 - === Starting Process Phase Notebook: Logging Setup Complete. Logs will be saved to: process_phase_20250213_190744.log ===
2025-02-13 19:07:44,551 - INFO - 2494785685 - --- Cell 1: Loading Prepared Datasets ---
2025-02-13 19:07:44,855 - INFO - 2494785685 - Loaded pbj_nurse with shape (1325324, 33)
2025-02-13 19:07:45,509 - INFO - 2494785685 - Loaded pbj_non_nurse with shape (1325324, 82)
2025-02-13 19:07:45,835 - INFO - 2494785685 - Loaded qrp_provider with shape (710016, 16)
2025-02-13 19:07:45,862 - INFO - 2494785685 - Loaded nh_survey with shape (44189, 41)
2025-02-13 19:07:45,964 - INFO - 2494785685 - Loaded nh_quality_mds with shape (251464, 23)
2025-02-13 19:07:46,041 - INFO - 2494785685 - Loaded nh_ownership with shape (144651, 13)
2025-02-13 19:07:46,465 - INFO - 2494785685 - Loaded nh_citations with shape (406789, 23)
2025-02-13 19:07:46,466 - INFO - 2494785685 - Verifying columns in pbj_nurse to identify correct names for calculations:
2025-02-13 19:07:46,466 - INFO - 2494785685 - Columns in pbj_nurse:
2025-02-13 19:07:46,466 - INFO - 2494785685 - ['provnum', 'provname', 'city', 'state', 'county_name', 'county_fips', 'cy_qtr', 'workdate', 'mdscensus', 'hrs_rndon', 'hrs_rndon_emp', 'hrs_rndon_ctr', 'hrs_rnadmin', 'hrs_rnadmin_emp', 'hrs_rnadmin_ctr', 'hrs_rn', 'hrs_rn_emp', 'hrs_rn_ctr', 'hrs_lpnadmin', 'hrs_lpnadmin_emp', 'hrs_lpnadmin_ctr', 'hrs_lpn', 'hrs_lpn_emp', 'hrs_lpn_ctr', 'hrs_cna', 'hrs_cna_emp', 'hrs_cna_ctr', 'hrs_natrn', 'hrs_natrn_emp', 'hrs_natrn_ctr', 'hrs_medaide', 'hrs_medaide_emp', 'hrs_medaide_ctr']
2025-02-13 19:07:46,466 - INFO - 2494785685 - --- Cell 2: Calculating Nursing Ratio ---
2025-02-13 19:07:46,466 - INFO - 2494785685 - --- Debugging Cell 2 - DataFrame Info and Type ---
2025-02-13 19:07:46,466 - INFO - 2494785685 - Type of pbj_nurse_df: <class 'pandas.core.frame.DataFrame'>
2025-02-13 19:07:46,477 - INFO - 2494785685 - <class 'pandas.core.frame.DataFrame'>
RangeIndex: 1325324 entries, 0 to 1325323
Columns: 33 entries, provnum to hrs_medaide_ctr
dtypes: datetime64[ns](1), float64(24), int64(2), object(6)
memory usage: 333.7+ MB
2025-02-13 19:07:46,477 - INFO - 2494785685 - First 5 rows of pbj_nurse_df:
2025-02-13 19:07:46,487 - INFO - 2494785685 - provnum                  provname          city state county_name  \
0  015009  BURNS NURSING HOME, INC.  RUSSELLVILLE    AL    Franklin   
1  015009  BURNS NURSING HOME, INC.  RUSSELLVILLE    AL    Franklin   
2  015009  BURNS NURSING HOME, INC.  RUSSELLVILLE    AL    Franklin   
3  015009  BURNS NURSING HOME, INC.  RUSSELLVILLE    AL    Franklin   
4  015009  BURNS NURSING HOME, INC.  RUSSELLVILLE    AL    Franklin   

   county_fips  cy_qtr   workdate  mdscensus  hrs_rndon  ...  hrs_lpn_ctr  \
0           59  2024Q2 2024-04-01         51      10.77  ...          0.0   
1           59  2024Q2 2024-04-02         52       8.43  ...          0.0   
2           59  2024Q2 2024-04-03         53      11.13  ...          0.0   
3           59  2024Q2 2024-04-04         52      12.27  ...          0.0   
4           59  2024Q2 2024-04-05         52       4.95  ...          0.0   

   hrs_cna  hrs_cna_emp  hrs_cna_ctr  hrs_natrn  hrs_natrn_emp  hrs_natrn_ctr  \
0   160.08       160.08          0.0        0.0            0.0            0.0   
1   135.95       135.95          0.0        0.0            0.0            0.0   
2   150.31       150.31          0.0        0.0            0.0            0.0   
3   133.01       133.01          0.0        0.0            0.0            0.0   
4   137.92       137.92          0.0        0.0            0.0            0.0   

   hrs_medaide  hrs_medaide_emp  hrs_medaide_ctr  
0          0.0              0.0              0.0  
1          0.0              0.0              0.0  
2          0.0              0.0              0.0  
3          0.0              0.0              0.0  
4          0.0              0.0              0.0  

[5 rows x 33 columns]
2025-02-13 19:07:46,487 - INFO - 2494785685 - Columns in pbj_nurse_df BEFORE Nursing Ratio calculation (again):
2025-02-13 19:07:46,487 - INFO - 2494785685 - ['provnum', 'provname', 'city', 'state', 'county_name', 'county_fips', 'cy_qtr', 'workdate', 'mdscensus', 'hrs_rndon', 'hrs_rndon_emp', 'hrs_rndon_ctr', 'hrs_rnadmin', 'hrs_rnadmin_emp', 'hrs_rnadmin_ctr', 'hrs_rn', 'hrs_rn_emp', 'hrs_rn_ctr', 'hrs_lpnadmin', 'hrs_lpnadmin_emp', 'hrs_lpnadmin_ctr', 'hrs_lpn', 'hrs_lpn_emp', 'hrs_lpn_ctr', 'hrs_cna', 'hrs_cna_emp', 'hrs_cna_ctr', 'hrs_natrn', 'hrs_natrn_emp', 'hrs_natrn_ctr', 'hrs_medaide', 'hrs_medaide_emp', 'hrs_medaide_ctr']
2025-02-13 19:07:46,487 - INFO - 2494785685 - --- Debugging Cell 2 - REPR Check of Column Names ---
2025-02-13 19:07:46,487 - INFO - 2494785685 - repr() of column names IN CODE (SNAKE CASE):
2025-02-13 19:07:46,487 - INFO - 2494785685 - ["'hrs_rn_ctr'", "'hrs_lpn_ctr'", "'hrs_cna_ctr'"]
2025-02-13 19:07:46,487 - INFO - 2494785685 - repr() of column names FROM DATAFRAME (SNAKE CASE - using your list from log):
2025-02-13 19:07:46,488 - INFO - 2494785685 - ["'hrs_rn_ctr'", "'hrs_lpn_ctr'", "'hrs_cna_ctr'"]
2025-02-13 19:07:46,752 - INFO - 2494785685 - Nursing Ratio Calculation Completed. Sample Data:
2025-02-13 19:07:46,767 - INFO - 2494785685 - Total Nursing Contract Hours  Total Nursing Employee Hours  \
0                           0.0                        241.28   
1                           0.0                        214.45   
2                           0.0                        232.06   
3                           0.0                        207.32   
4                           0.0                        219.40   

   Total Nursing Hours (Employee + Contract)  Nursing Ratio  
0                                     241.28            0.0  
1                                     214.45            0.0  
2                                     232.06            0.0  
3                                     207.32            0.0  
4                                     219.40            0.0
2025-02-13 19:07:46,769 - INFO - 2494785685 - --- Cell 3: Calculating Non-Nursing Ratio ---
2025-02-13 19:07:46,769 - INFO - 2494785685 - --- Debugging Cell 3 - DataFrame Info and Type ---
2025-02-13 19:07:46,770 - INFO - 2494785685 - Type of pbj_non_nurse_df: <class 'pandas.core.frame.DataFrame'>
2025-02-13 19:07:46,773 - INFO - 2494785685 - <class 'pandas.core.frame.DataFrame'>
RangeIndex: 1325324 entries, 0 to 1325323
Columns: 82 entries, provnum to hrs_mhsvc_ctr
dtypes: datetime64[ns](1), float64(73), int64(2), object(6)
memory usage: 829.1+ MB
2025-02-13 19:07:46,773 - INFO - 2494785685 - First 5 rows of pbj_non_nurse_df:
2025-02-13 19:07:46,777 - INFO - 2494785685 - provnum                  provname          city state county_name  \
0  015009  BURNS NURSING HOME, INC.  RUSSELLVILLE    AL    Franklin   
1  015009  BURNS NURSING HOME, INC.  RUSSELLVILLE    AL    Franklin   
2  015009  BURNS NURSING HOME, INC.  RUSSELLVILLE    AL    Franklin   
3  015009  BURNS NURSING HOME, INC.  RUSSELLVILLE    AL    Franklin   
4  015009  BURNS NURSING HOME, INC.  RUSSELLVILLE    AL    Franklin   

   county_fips  cy_qtr   workdate  mdscensus  hrs_admin  ...  hrs_othactv_ctr  \
0           59  2024Q2 2024-04-01         51        8.0  ...              0.0   
1           59  2024Q2 2024-04-02         52        8.0  ...              0.0   
2           59  2024Q2 2024-04-03         53        8.0  ...              0.0   
3           59  2024Q2 2024-04-04         52        8.0  ...              0.0   
4           59  2024Q2 2024-04-05         52        8.0  ...              0.0   

   hrs_qualsocwrk  hrs_qualsocwrk_emp  hrs_qualsocwrk_ctr  hrs_othsocwrk  \
0            6.65                6.65                 0.0            0.0   
1            9.02                9.02                 0.0            0.0   
2            9.13                9.13                 0.0            0.0   
3            7.32                7.32                 0.0            0.0   
4            8.53                8.53                 0.0            0.0   

   hrs_othsocwrk_emp  hrs_othsocwrk_ctr  hrs_mhsvc  hrs_mhsvc_emp  \
0                0.0                0.0        0.0            0.0   
1                0.0                0.0        0.0            0.0   
2                0.0                0.0        0.0            0.0   
3                0.0                0.0        0.0            0.0   
4                0.0                0.0        0.0            0.0   

   hrs_mhsvc_ctr  
0            0.0  
1            0.0  
2            0.0  
3            0.0  
4            0.0  

[5 rows x 82 columns]
2025-02-13 19:07:46,777 - INFO - 2494785685 - Columns in pbj_non_nurse_df BEFORE Non-Nursing Ratio calculation (again):
2025-02-13 19:07:46,778 - INFO - 2494785685 - ['provnum', 'provname', 'city', 'state', 'county_name', 'county_fips', 'cy_qtr', 'workdate', 'mdscensus', 'hrs_admin', 'hrs_admin_emp', 'hrs_admin_ctr', 'hrs_admin_fn', 'hrs_meddir', 'hrs_meddir_emp', 'hrs_meddir_ctr', 'hrs_othmd', 'hrs_othmd_emp', 'hrs_othmd_ctr', 'hrs_pa', 'hrs_pa_emp', 'hrs_pa_ctr', 'hrs_np', 'hrs_np_emp', 'hrs_np_ctr', 'hrs_clinnrsspec', 'hrs_clinnrsspec_emp', 'hrs_clinnrsspec_ctr', 'hrs_pharmacist', 'hrs_pharmacist_emp', 'hrs_pharmacist_ctr', 'hrs_dietician', 'hrs_dietician_emp', 'hrs_dietician_ctr', 'hrs_feedasst', 'hrs_feedasst_emp', 'hrs_feedasst_ctr', 'hrs_ot', 'hrs_ot_emp', 'hrs_ot_ctr', 'hrs_otasst', 'hrs_otasst_emp', 'hrs_otasst_ctr', 'hrs_otaide', 'hrs_otaide_emp', 'hrs_otaide_ctr', 'hrs_pt', 'hrs_pt_emp', 'hrs_pt_ctr', 'hrs_ptasst', 'hrs_ptasst_emp', 'hrs_ptasst_ctr', 'hrs_ptaide', 'hrs_ptaide_emp', 'hrs_ptaide_ctr', 'hrs_respther', 'hrs_respther_emp', 'hrs_respther_ctr', 'hrs_resptech', 'hrs_resptech_emp', 'hrs_resptech_ctr', 'hrs_spclangpath', 'hrs_spclangpath_emp', 'hrs_spclangpath_ctr', 'hrs_therrecspec', 'hrs_therrecspec_emp', 'hrs_therrecspec_ctr', 'hrs_qualactvprof', 'hrs_qualactvprof_emp', 'hrs_qualactvprof_ctr', 'hrs_othactv', 'hrs_othactv_emp', 'hrs_othactv_ctr', 'hrs_qualsocwrk', 'hrs_qualsocwrk_emp', 'hrs_qualsocwrk_ctr', 'hrs_othsocwrk', 'hrs_othsocwrk_emp', 'hrs_othsocwrk_ctr', 'hrs_mhsvc', 'hrs_mhsvc_emp', 'hrs_mhsvc_ctr']
2025-02-13 19:08:09,074 - INFO - 2494785685 - Non-Nursing Ratio Calculation Completed. Sample Data:
2025-02-13 19:08:09,086 - INFO - 2494785685 - Sum of Contract Hours for Support Roles  \
0                                    25.25   
1                                    20.00   
2                                    23.75   
3                                    24.50   
4                                    20.00   

   Sum of Employee Hours for Support Roles  \
0                                    38.66   
1                                    31.44   
2                                    41.29   
3                                    31.20   
4                                    40.31   

   Sum of (Employee + Contract) Hours for Support Roles  Non-Nursing Ratio  
0                                              63.91              0.395087  
1                                              51.44              0.388802  
2                                              65.04              0.365160  
3                                              55.70              0.439856  
4                                              60.31              0.331620
2025-02-13 19:08:09,088 - INFO - 2494785685 - --- Cell 4: Verifying Calculations - Sample Output ---
2025-02-13 19:08:09,088 - INFO - 2494785685 - Sample from pbj_nurse_df with Nursing Ratio:
2025-02-13 19:17:11,880 - INFO - 2494785685 - Loaded pbj_nurse with shape (1325324, 33)
2025-02-13 19:17:12,384 - INFO - 2494785685 - Loaded pbj_non_nurse with shape (1325324, 82)
2025-02-13 19:17:12,683 - INFO - 2494785685 - Loaded qrp_provider with shape (710016, 16)
2025-02-13 19:17:12,706 - INFO - 2494785685 - Loaded nh_survey with shape (44189, 41)
2025-02-13 19:17:12,808 - INFO - 2494785685 - Loaded nh_quality_mds with shape (251464, 23)
2025-02-13 19:17:12,880 - INFO - 2494785685 - Loaded nh_ownership with shape (144651, 13)
2025-02-13 19:17:13,117 - INFO - 2494785685 - Loaded nh_citations with shape (406789, 23)
2025-02-13 19:17:13,117 - INFO - 2494785685 - Columns in pbj_nurse:
2025-02-13 19:17:13,117 - INFO - 2494785685 - ['provnum', 'provname', 'city', 'state', 'county_name', 'county_fips', 'cy_qtr', 'workdate', 'mdscensus', 'hrs_rndon', 'hrs_rndon_emp', 'hrs_rndon_ctr', 'hrs_rnadmin', 'hrs_rnadmin_emp', 'hrs_rnadmin_ctr', 'hrs_rn', 'hrs_rn_emp', 'hrs_rn_ctr', 'hrs_lpnadmin', 'hrs_lpnadmin_emp', 'hrs_lpnadmin_ctr', 'hrs_lpn', 'hrs_lpn_emp', 'hrs_lpn_ctr', 'hrs_cna', 'hrs_cna_emp', 'hrs_cna_ctr', 'hrs_natrn', 'hrs_natrn_emp', 'hrs_natrn_ctr', 'hrs_medaide', 'hrs_medaide_emp', 'hrs_medaide_ctr']
