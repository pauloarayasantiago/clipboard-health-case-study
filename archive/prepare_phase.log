Starting Prepare Phase...
Error loading ./data/raw/PBJ_Daily_Nurse_Staffing_Q2_2024.csv: 'utf-8' codec can't decode byte 0x92 in position 173163: invalid start byte
Error loading ./data/raw/PBJ_Daily_Non_Nurse_Staffing_Q2_2024.csv: 'utf-8' codec can't decode byte 0x92 in position 49461: invalid start byte
Starting Prepare Phase...
Error loading ./data/raw/PBJ_Daily_Nurse_Staffing_Q2_2024.csv: 'utf-8' codec can't decode byte 0x92 in position 173163: invalid start byte
Error loading ./data/raw/PBJ_Daily_Non_Nurse_Staffing_Q2_2024.csv: 'utf-8' codec can't decode byte 0x92 in position 49461: invalid start byte
qrp_provider Loaded: 710016 rows, 16 columns.
2025-02-12 17:09:43,077 - INFO - Starting Prepare Phase Script
2025-02-12 17:09:43,077 - INFO - Attempting to load dataset: pbj_nurse from ./data/raw/PBJ_Daily_Nurse_Staffing_Q2_2024.csv
2025-02-12 17:09:43,225 - ERROR - Error loading dataset: pbj_nurse from ./data/raw/PBJ_Daily_Nurse_Staffing_Q2_2024.csv. Error: 'utf-8' codec can't decode byte 0x92 in position 173163: invalid start byte
2025-02-12 17:09:43,225 - INFO - Attempting to load dataset: pbj_non_nurse from ./data/raw/PBJ_Daily_Non_Nurse_Staffing_Q2_2024.csv
2025-02-12 17:09:43,494 - ERROR - Error loading dataset: pbj_non_nurse from ./data/raw/PBJ_Daily_Non_Nurse_Staffing_Q2_2024.csv. Error: 'utf-8' codec can't decode byte 0x92 in position 49461: invalid start byte
2025-02-12 17:09:43,495 - INFO - Attempting to load dataset: qrp_provider from ./data/raw/Skilled_Nursing_Facility_Quality_Reporting_Program_Provider_Data_Jan2025.csv
2025-02-12 17:09:44,541 - INFO - Dataset: qrp_provider loaded successfully.
2025-02-12 17:09:44,541 - INFO - Converting qrp_provider to Parquet format and saving to ./data/processed/qrp_provider.parquet
2025-02-12 17:09:45,336 - INFO - Dataset: qrp_provider converted to Parquet and saved.
2025-02-12 17:09:45,336 - INFO - Attempting to load dataset: nh_survey from ./data/raw/NH_SurveySummary_Jan2025.csv
2025-02-12 17:09:45,447 - INFO - Dataset: nh_survey loaded successfully.
2025-02-12 17:09:45,447 - INFO - Converting nh_survey to Parquet format and saving to ./data/processed/nh_survey.parquet
2025-02-12 17:09:45,518 - INFO - Dataset: nh_survey converted to Parquet and saved.
2025-02-12 17:09:45,519 - INFO - Attempting to load dataset: nh_quality_mds from ./data/raw/NH_QualityMeasures_MDS_Jan2025.csv
2025-02-12 17:09:45,519 - ERROR - Error: File not found for dataset: nh_quality_mds at ./data/raw/NH_QualityMeasures_MDS_Jan2025.csv
2025-02-12 17:09:45,519 - INFO - Attempting to load dataset: nh_ownership from ./data/raw/NH_Ownership_Jan2025.csv
2025-02-12 17:09:45,749 - INFO - Dataset: nh_ownership loaded successfully.
2025-02-12 17:09:45,750 - INFO - Converting nh_ownership to Parquet format and saving to ./data/processed/nh_ownership.parquet
2025-02-12 17:09:45,912 - INFO - Dataset: nh_ownership converted to Parquet and saved.
2025-02-12 17:09:45,912 - INFO - Attempting to load dataset: nh_citations from ./data/raw/NH_HealthCitations_Jan2025.csv
2025-02-12 17:09:47,117 - INFO - Dataset: nh_citations loaded successfully.
2025-02-12 17:09:47,117 - INFO - Converting nh_citations to Parquet format and saving to ./data/processed/nh_citations.parquet
2025-02-12 17:09:47,789 - INFO - Dataset: nh_citations converted to Parquet and saved.
2025-02-12 17:09:47,789 - INFO - Data loading and conversion to Parquet completed.
2025-02-12 17:09:47,790 - INFO - Prepare Phase Script Completed
2025-02-12 17:18:57,531 - INFO - Starting Prepare Phase Script
2025-02-12 17:18:57,531 - INFO - Attempting to load dataset: pbj_nurse from ./data/raw/PBJ_Daily_Nurse_Staffing_Q2_2024.csv
2025-02-12 17:18:59,926 - INFO - Dataset: pbj_nurse loaded successfully.
2025-02-12 17:18:59,926 - INFO - Converting pbj_nurse to Parquet format and saving to ./data/processed/pbj_nurse.parquet
2025-02-12 17:19:01,141 - INFO - Dataset: pbj_nurse converted to Parquet and saved.
2025-02-12 17:19:01,141 - INFO - Attempting to load dataset: pbj_non_nurse from ./data/raw/PBJ_Daily_Non_Nurse_Staffing_Q2_2024.csv
2025-02-12 17:19:07,401 - INFO - Dataset: pbj_non_nurse loaded successfully.
2025-02-12 17:19:07,401 - INFO - Converting pbj_non_nurse to Parquet format and saving to ./data/processed/pbj_non_nurse.parquet
2025-02-12 17:19:09,833 - INFO - Dataset: pbj_non_nurse converted to Parquet and saved.
2025-02-12 17:19:09,833 - INFO - Attempting to load dataset: qrp_provider from ./data/raw/Skilled_Nursing_Facility_Quality_Reporting_Program_Provider_Data_Jan2025.csv
2025-02-12 17:19:11,014 - INFO - Dataset: qrp_provider loaded successfully.
2025-02-12 17:19:11,014 - INFO - Converting qrp_provider to Parquet format and saving to ./data/processed/qrp_provider.parquet
2025-02-12 17:19:11,931 - INFO - Dataset: qrp_provider converted to Parquet and saved.
2025-02-12 17:19:11,931 - INFO - Attempting to load dataset: nh_survey from ./data/raw/NH_SurveySummary_Jan2025.csv
2025-02-12 17:19:12,099 - INFO - Dataset: nh_survey loaded successfully.
2025-02-12 17:19:12,099 - INFO - Converting nh_survey to Parquet format and saving to ./data/processed/nh_survey.parquet
2025-02-12 17:19:12,218 - INFO - Dataset: nh_survey converted to Parquet and saved.
2025-02-12 17:19:12,218 - INFO - Attempting to load dataset: nh_quality_mds from ./data/raw/NH_QualityMsr_MDS_Jan2025.csv
2025-02-12 17:19:13,163 - INFO - Dataset: nh_quality_mds loaded successfully.
2025-02-12 17:19:13,163 - INFO - Converting nh_quality_mds to Parquet format and saving to ./data/processed/nh_quality_mds.parquet
2025-02-12 17:19:13,734 - INFO - Dataset: nh_quality_mds converted to Parquet and saved.
2025-02-12 17:19:13,735 - INFO - Attempting to load dataset: nh_ownership from ./data/raw/NH_Ownership_Jan2025.csv
2025-02-12 17:19:14,142 - INFO - Dataset: nh_ownership loaded successfully.
2025-02-12 17:19:14,142 - INFO - Converting nh_ownership to Parquet format and saving to ./data/processed/nh_ownership.parquet
2025-02-12 17:19:14,415 - INFO - Dataset: nh_ownership converted to Parquet and saved.
2025-02-12 17:19:14,415 - INFO - Attempting to load dataset: nh_citations from ./data/raw/NH_HealthCitations_Jan2025.csv
2025-02-12 17:19:15,950 - INFO - Dataset: nh_citations loaded successfully.
2025-02-12 17:19:15,950 - INFO - Converting nh_citations to Parquet format and saving to ./data/processed/nh_citations.parquet
2025-02-12 17:19:16,780 - INFO - Dataset: nh_citations converted to Parquet and saved.
2025-02-12 17:19:16,780 - INFO - Data loading and conversion to Parquet completed.
2025-02-12 17:19:22,181 - INFO - Prepare Phase Script Completed
2025-02-12 22:12:03,349 - INFO - Starting Prepare Phase Script
2025-02-12 22:12:23,494 - ERROR - Error loading data from ./data/raw/PBJ_Daily_Nurse_Staffing_Q2_2024.csv: 'utf-8' codec can't decode byte 0x92 in position 173163: invalid start byte
2025-02-12 22:12:23,495 - ERROR - Failed to process dataset pbj_nurse: 'utf-8' codec can't decode byte 0x92 in position 173163: invalid start byte
2025-02-12 22:12:40,799 - ERROR - Error loading data from ./data/raw/PBJ_Daily_Non_Nurse_Staffing_Q2_2024.csv: 'utf-8' codec can't decode byte 0x92 in position 49461: invalid start byte
2025-02-12 22:12:40,799 - ERROR - Failed to process dataset pbj_non_nurse: 'utf-8' codec can't decode byte 0x92 in position 49461: invalid start byte
2025-02-12 22:12:49,876 - INFO - Data loaded from ./data/raw/Skilled_Nursing_Facility_Quality_Reporting_Program_Provider_Data_Jan2025.csv with shape (710016, 16).
2025-02-12 22:12:49,877 - INFO - Column names standardized.
2025-02-12 22:12:50,486 - INFO - Dropped duplicates: shape changed from (710016, 16) to (710016, 16).
2025-02-12 22:12:50,730 - INFO - Missing values before handling: {'cms certification number (ccn)': 0, 'provider name': 0, 'address line 1': 0, 'city/town': 0, 'state': 0, 'zip code': 0, 'county/parish': 0, 'telephone number': 0, 'cms region': 0, 'measure code': 0, 'score': 0, 'footnote': 0, 'start date': 0, 'end date': 0, 'measure date range': 0, 'location1': 0}
2025-02-12 22:12:51,007 - INFO - Dropped rows with missing values.
2025-02-12 22:12:51,251 - INFO - Missing values after handling: {'cms certification number (ccn)': 0, 'provider name': 0, 'address line 1': 0, 'city/town': 0, 'state': 0, 'zip code': 0, 'county/parish': 0, 'telephone number': 0, 'cms region': 0, 'measure code': 0, 'score': 0, 'footnote': 0, 'start date': 0, 'end date': 0, 'measure date range': 0, 'location1': 0}
2025-02-12 22:12:51,279 - INFO - Computed summary statistics.
2025-02-12 22:12:54,742 - INFO - Prepared data saved to ./data/processed/Skilled_Nursing_Facility_Quality_Reporting_Program_Provider_Data_Jan2025.csv
2025-02-12 22:12:54,761 - INFO - Successfully processed dataset: qrp_provider
2025-02-12 22:12:55,639 - INFO - Data loaded from ./data/raw/NH_SurveySummary_Jan2025.csv with shape (44189, 41).
2025-02-12 22:12:55,639 - INFO - Column names standardized.
2025-02-12 22:12:55,687 - INFO - Dropped duplicates: shape changed from (44189, 41) to (44189, 41).
2025-02-12 22:12:55,699 - INFO - Missing values before handling: {'cms certification number (ccn)': 0, 'provider name': 0, 'provider address': 0, 'city/town': 0, 'state': 0, 'zip code': 0, 'inspection cycle': 0, 'health survey date': 0, 'fire safety survey date': 33, 'total number of health deficiencies': 0, 'total number of fire safety deficiencies': 33, 'count of freedom from abuse and neglect and exploitation deficiencies': 0, 'count of quality of life and care deficiencies': 0, 'count of resident assessment and care planning deficiencies': 0, 'count of nursing and physician services deficiencies': 0, 'count of resident rights deficiencies': 0, 'count of nutrition and dietary deficiencies': 0, 'count of pharmacy service deficiencies': 0, 'count of environmental deficiencies': 0, 'count of administration deficiencies': 0, 'count of infection control deficiencies': 0, 'count of emergency preparedness deficiencies': 33, 'count of automatic sprinkler systems deficiencies': 33, 'count of construction deficiencies': 33, 'count of services deficiencies': 33, 'count of corridor walls and doors deficiencies': 33, 'count of egress deficiencies': 33, 'count of electrical deficiencies': 33, 'count of emergency plans and fire drills deficiencies': 33, 'count of fire alarm systems deficiencies': 33, 'count of smoke deficiencies': 33, 'count of interior deficiencies': 33, 'count of gas and vacuum and electrical systems deficiencies': 33, 'count of hazardous area deficiencies': 33, 'count of illumination and emergency power deficiencies': 33, 'count of laboratories deficiencies': 33, 'count of medical gases and anaesthetizing areas deficiencies': 33, 'count of smoking regulations deficiencies': 33, 'count of miscellaneous deficiencies': 33, 'location': 0, 'processing date': 0}
2025-02-12 22:12:55,717 - INFO - Dropped rows with missing values.
2025-02-12 22:12:55,729 - INFO - Missing values after handling: {'cms certification number (ccn)': 0, 'provider name': 0, 'provider address': 0, 'city/town': 0, 'state': 0, 'zip code': 0, 'inspection cycle': 0, 'health survey date': 0, 'fire safety survey date': 0, 'total number of health deficiencies': 0, 'total number of fire safety deficiencies': 0, 'count of freedom from abuse and neglect and exploitation deficiencies': 0, 'count of quality of life and care deficiencies': 0, 'count of resident assessment and care planning deficiencies': 0, 'count of nursing and physician services deficiencies': 0, 'count of resident rights deficiencies': 0, 'count of nutrition and dietary deficiencies': 0, 'count of pharmacy service deficiencies': 0, 'count of environmental deficiencies': 0, 'count of administration deficiencies': 0, 'count of infection control deficiencies': 0, 'count of emergency preparedness deficiencies': 0, 'count of automatic sprinkler systems deficiencies': 0, 'count of construction deficiencies': 0, 'count of services deficiencies': 0, 'count of corridor walls and doors deficiencies': 0, 'count of egress deficiencies': 0, 'count of electrical deficiencies': 0, 'count of emergency plans and fire drills deficiencies': 0, 'count of fire alarm systems deficiencies': 0, 'count of smoke deficiencies': 0, 'count of interior deficiencies': 0, 'count of gas and vacuum and electrical systems deficiencies': 0, 'count of hazardous area deficiencies': 0, 'count of illumination and emergency power deficiencies': 0, 'count of laboratories deficiencies': 0, 'count of medical gases and anaesthetizing areas deficiencies': 0, 'count of smoking regulations deficiencies': 0, 'count of miscellaneous deficiencies': 0, 'location': 0, 'processing date': 0}
2025-02-12 22:12:55,776 - INFO - Computed summary statistics.
2025-02-12 22:12:56,319 - INFO - Prepared data saved to ./data/processed/NH_SurveySummary_Jan2025.csv
2025-02-12 22:12:56,320 - INFO - Successfully processed dataset: nh_survey
2025-02-12 22:13:00,760 - INFO - Data loaded from ./data/raw/NH_QualityMsr_MDS_Jan2025.csv with shape (251464, 23).
2025-02-12 22:13:00,761 - INFO - Column names standardized.
2025-02-12 22:13:01,040 - INFO - Dropped duplicates: shape changed from (251464, 23) to (251464, 23).
2025-02-12 22:13:01,111 - INFO - Missing values before handling: {'cms certification number (ccn)': 0, 'provider name': 0, 'provider address': 0, 'city/town': 0, 'state': 0, 'zip code': 0, 'measure code': 0, 'measure description': 0, 'resident type': 0, 'q1 measure score': 64416, 'footnote for q1 measure score': 187048, 'q2 measure score': 30096, 'footnote for q2 measure score': 221368, 'q3 measure score': 29209, 'footnote for q3 measure score': 222255, 'q4 measure score': 28945, 'footnote for q4 measure score': 222519, 'four quarter average score': 8775, 'footnote for four quarter average score': 242689, 'used in quality measure five star rating': 0, 'measure period': 0, 'location': 0, 'processing date': 0}
2025-02-12 22:13:01,195 - INFO - Dropped rows with missing values.
2025-02-12 22:13:01,196 - INFO - Missing values after handling: {'cms certification number (ccn)': 0, 'provider name': 0, 'provider address': 0, 'city/town': 0, 'state': 0, 'zip code': 0, 'measure code': 0, 'measure description': 0, 'resident type': 0, 'q1 measure score': 0, 'footnote for q1 measure score': 0, 'q2 measure score': 0, 'footnote for q2 measure score': 0, 'q3 measure score': 0, 'footnote for q3 measure score': 0, 'q4 measure score': 0, 'footnote for q4 measure score': 0, 'four quarter average score': 0, 'footnote for four quarter average score': 0, 'used in quality measure five star rating': 0, 'measure period': 0, 'location': 0, 'processing date': 0}
2025-02-12 22:13:01,205 - INFO - Computed summary statistics.
2025-02-12 22:13:01,206 - INFO - Prepared data saved to ./data/processed/NH_QualityMsr_MDS_Jan2025.csv
2025-02-12 22:13:01,214 - INFO - Successfully processed dataset: nh_quality_mds
2025-02-12 22:13:03,252 - INFO - Data loaded from ./data/raw/NH_Ownership_Jan2025.csv with shape (144651, 13).
2025-02-12 22:13:03,252 - INFO - Column names standardized.
2025-02-12 22:13:03,381 - INFO - Dropped duplicates: shape changed from (144651, 13) to (144651, 13).
2025-02-12 22:13:03,424 - INFO - Missing values before handling: {'cms certification number (ccn)': 0, 'provider name': 0, 'provider address': 0, 'city/town': 0, 'state': 0, 'zip code': 0, 'role played by owner or manager in facility': 0, 'owner type': 595, 'owner name': 595, 'ownership percentage': 595, 'association date': 595, 'location': 0, 'processing date': 0}
2025-02-12 22:13:03,483 - INFO - Dropped rows with missing values.
2025-02-12 22:13:03,526 - INFO - Missing values after handling: {'cms certification number (ccn)': 0, 'provider name': 0, 'provider address': 0, 'city/town': 0, 'state': 0, 'zip code': 0, 'role played by owner or manager in facility': 0, 'owner type': 0, 'owner name': 0, 'ownership percentage': 0, 'association date': 0, 'location': 0, 'processing date': 0}
2025-02-12 22:13:03,530 - INFO - Computed summary statistics.
2025-02-12 22:13:04,202 - INFO - Prepared data saved to ./data/processed/NH_Ownership_Jan2025.csv
2025-02-12 22:13:04,206 - INFO - Successfully processed dataset: nh_ownership
2025-02-12 22:13:13,847 - INFO - Data loaded from ./data/raw/NH_HealthCitations_Jan2025.csv with shape (406789, 23).
2025-02-12 22:13:13,847 - INFO - Column names standardized.
2025-02-12 22:13:14,414 - INFO - Dropped duplicates: shape changed from (406789, 23) to (406789, 23).
2025-02-12 22:13:14,609 - INFO - Missing values before handling: {'cms certification number (ccn)': 0, 'provider name': 0, 'provider address': 0, 'city/town': 0, 'state': 0, 'zip code': 0, 'survey date': 0, 'survey type': 0, 'deficiency prefix': 0, 'deficiency category': 0, 'deficiency tag number': 0, 'deficiency description': 0, 'scope severity code': 0, 'deficiency corrected': 0, 'correction date': 1392, 'inspection cycle': 0, 'standard deficiency': 0, 'complaint deficiency': 0, 'infection control inspection deficiency': 0, 'citation under idr': 0, 'citation under iidr': 0, 'location': 0, 'processing date': 0}
2025-02-12 22:13:14,856 - INFO - Dropped rows with missing values.
2025-02-12 22:13:15,050 - INFO - Missing values after handling: {'cms certification number (ccn)': 0, 'provider name': 0, 'provider address': 0, 'city/town': 0, 'state': 0, 'zip code': 0, 'survey date': 0, 'survey type': 0, 'deficiency prefix': 0, 'deficiency category': 0, 'deficiency tag number': 0, 'deficiency description': 0, 'scope severity code': 0, 'deficiency corrected': 0, 'correction date': 0, 'inspection cycle': 0, 'standard deficiency': 0, 'complaint deficiency': 0, 'infection control inspection deficiency': 0, 'citation under idr': 0, 'citation under iidr': 0, 'location': 0, 'processing date': 0}
2025-02-12 22:13:15,079 - INFO - Computed summary statistics.
2025-02-12 22:13:18,355 - INFO - Prepared data saved to ./data/processed/NH_HealthCitations_Jan2025.csv
2025-02-12 22:13:18,368 - INFO - Successfully processed dataset: nh_citations
2025-02-12 22:17:55,209 - INFO - Starting Prepare Phase Script
2025-02-12 22:17:55,380 - ERROR - Error loading data from ./data/raw/PBJ_Daily_Nurse_Staffing_Q2_2024.csv: 'utf-8' codec can't decode byte 0x92 in position 173163: invalid start byte
2025-02-12 22:17:55,381 - ERROR - Failed to process dataset pbj_nurse: 'utf-8' codec can't decode byte 0x92 in position 173163: invalid start byte
2025-02-12 22:17:55,643 - ERROR - Error loading data from ./data/raw/PBJ_Daily_Non_Nurse_Staffing_Q2_2024.csv: 'utf-8' codec can't decode byte 0x92 in position 49461: invalid start byte
2025-02-12 22:17:55,643 - ERROR - Failed to process dataset pbj_non_nurse: 'utf-8' codec can't decode byte 0x92 in position 49461: invalid start byte
2025-02-12 22:17:56,916 - INFO - Data loaded from ./data/raw/Skilled_Nursing_Facility_Quality_Reporting_Program_Provider_Data_Jan2025.csv with shape (710016, 16).
2025-02-12 22:17:56,917 - INFO - Column names standardized.
2025-02-12 22:17:57,511 - INFO - Dropped duplicates: shape changed from (710016, 16) to (710016, 16).
2025-02-12 22:17:57,752 - INFO - Missing values before handling: {'cms certification number (ccn)': 0, 'provider name': 0, 'address line 1': 0, 'city/town': 0, 'state': 0, 'zip code': 0, 'county/parish': 0, 'telephone number': 0, 'cms region': 0, 'measure code': 0, 'score': 0, 'footnote': 0, 'start date': 0, 'end date': 0, 'measure date range': 0, 'location1': 0}
2025-02-12 22:17:58,031 - INFO - Dropped rows with missing values.
2025-02-12 22:17:58,273 - INFO - Missing values after handling: {'cms certification number (ccn)': 0, 'provider name': 0, 'address line 1': 0, 'city/town': 0, 'state': 0, 'zip code': 0, 'county/parish': 0, 'telephone number': 0, 'cms region': 0, 'measure code': 0, 'score': 0, 'footnote': 0, 'start date': 0, 'end date': 0, 'measure date range': 0, 'location1': 0}
2025-02-12 22:17:58,296 - INFO - Computed summary statistics.
2025-02-12 22:18:01,589 - INFO - Prepared data saved to ./data/processed/Skilled_Nursing_Facility_Quality_Reporting_Program_Provider_Data_Jan2025.csv
2025-02-12 22:18:01,621 - INFO - Successfully processed dataset: qrp_provider
2025-02-12 22:18:01,802 - INFO - Data loaded from ./data/raw/NH_SurveySummary_Jan2025.csv with shape (44189, 41).
2025-02-12 22:18:01,803 - INFO - Column names standardized.
2025-02-12 22:18:01,853 - INFO - Dropped duplicates: shape changed from (44189, 41) to (44189, 41).
2025-02-12 22:18:01,865 - INFO - Missing values before handling: {'cms certification number (ccn)': 0, 'provider name': 0, 'provider address': 0, 'city/town': 0, 'state': 0, 'zip code': 0, 'inspection cycle': 0, 'health survey date': 0, 'fire safety survey date': 33, 'total number of health deficiencies': 0, 'total number of fire safety deficiencies': 33, 'count of freedom from abuse and neglect and exploitation deficiencies': 0, 'count of quality of life and care deficiencies': 0, 'count of resident assessment and care planning deficiencies': 0, 'count of nursing and physician services deficiencies': 0, 'count of resident rights deficiencies': 0, 'count of nutrition and dietary deficiencies': 0, 'count of pharmacy service deficiencies': 0, 'count of environmental deficiencies': 0, 'count of administration deficiencies': 0, 'count of infection control deficiencies': 0, 'count of emergency preparedness deficiencies': 33, 'count of automatic sprinkler systems deficiencies': 33, 'count of construction deficiencies': 33, 'count of services deficiencies': 33, 'count of corridor walls and doors deficiencies': 33, 'count of egress deficiencies': 33, 'count of electrical deficiencies': 33, 'count of emergency plans and fire drills deficiencies': 33, 'count of fire alarm systems deficiencies': 33, 'count of smoke deficiencies': 33, 'count of interior deficiencies': 33, 'count of gas and vacuum and electrical systems deficiencies': 33, 'count of hazardous area deficiencies': 33, 'count of illumination and emergency power deficiencies': 33, 'count of laboratories deficiencies': 33, 'count of medical gases and anaesthetizing areas deficiencies': 33, 'count of smoking regulations deficiencies': 33, 'count of miscellaneous deficiencies': 33, 'location': 0, 'processing date': 0}
2025-02-12 22:18:01,884 - INFO - Dropped rows with missing values.
2025-02-12 22:18:01,896 - INFO - Missing values after handling: {'cms certification number (ccn)': 0, 'provider name': 0, 'provider address': 0, 'city/town': 0, 'state': 0, 'zip code': 0, 'inspection cycle': 0, 'health survey date': 0, 'fire safety survey date': 0, 'total number of health deficiencies': 0, 'total number of fire safety deficiencies': 0, 'count of freedom from abuse and neglect and exploitation deficiencies': 0, 'count of quality of life and care deficiencies': 0, 'count of resident assessment and care planning deficiencies': 0, 'count of nursing and physician services deficiencies': 0, 'count of resident rights deficiencies': 0, 'count of nutrition and dietary deficiencies': 0, 'count of pharmacy service deficiencies': 0, 'count of environmental deficiencies': 0, 'count of administration deficiencies': 0, 'count of infection control deficiencies': 0, 'count of emergency preparedness deficiencies': 0, 'count of automatic sprinkler systems deficiencies': 0, 'count of construction deficiencies': 0, 'count of services deficiencies': 0, 'count of corridor walls and doors deficiencies': 0, 'count of egress deficiencies': 0, 'count of electrical deficiencies': 0, 'count of emergency plans and fire drills deficiencies': 0, 'count of fire alarm systems deficiencies': 0, 'count of smoke deficiencies': 0, 'count of interior deficiencies': 0, 'count of gas and vacuum and electrical systems deficiencies': 0, 'count of hazardous area deficiencies': 0, 'count of illumination and emergency power deficiencies': 0, 'count of laboratories deficiencies': 0, 'count of medical gases and anaesthetizing areas deficiencies': 0, 'count of smoking regulations deficiencies': 0, 'count of miscellaneous deficiencies': 0, 'location': 0, 'processing date': 0}
2025-02-12 22:18:01,945 - INFO - Computed summary statistics.
2025-02-12 22:18:02,510 - INFO - Prepared data saved to ./data/processed/NH_SurveySummary_Jan2025.csv
2025-02-12 22:18:02,512 - INFO - Successfully processed dataset: nh_survey
2025-02-12 22:18:03,228 - INFO - Data loaded from ./data/raw/NH_QualityMsr_MDS_Jan2025.csv with shape (251464, 23).
2025-02-12 22:18:03,229 - INFO - Column names standardized.
2025-02-12 22:18:03,501 - INFO - Dropped duplicates: shape changed from (251464, 23) to (251464, 23).
2025-02-12 22:18:03,573 - INFO - Missing values before handling: {'cms certification number (ccn)': 0, 'provider name': 0, 'provider address': 0, 'city/town': 0, 'state': 0, 'zip code': 0, 'measure code': 0, 'measure description': 0, 'resident type': 0, 'q1 measure score': 64416, 'footnote for q1 measure score': 187048, 'q2 measure score': 30096, 'footnote for q2 measure score': 221368, 'q3 measure score': 29209, 'footnote for q3 measure score': 222255, 'q4 measure score': 28945, 'footnote for q4 measure score': 222519, 'four quarter average score': 8775, 'footnote for four quarter average score': 242689, 'used in quality measure five star rating': 0, 'measure period': 0, 'location': 0, 'processing date': 0}
2025-02-12 22:18:03,648 - INFO - Dropped rows with missing values.
2025-02-12 22:18:03,648 - INFO - Missing values after handling: {'cms certification number (ccn)': 0, 'provider name': 0, 'provider address': 0, 'city/town': 0, 'state': 0, 'zip code': 0, 'measure code': 0, 'measure description': 0, 'resident type': 0, 'q1 measure score': 0, 'footnote for q1 measure score': 0, 'q2 measure score': 0, 'footnote for q2 measure score': 0, 'q3 measure score': 0, 'footnote for q3 measure score': 0, 'q4 measure score': 0, 'footnote for q4 measure score': 0, 'four quarter average score': 0, 'footnote for four quarter average score': 0, 'used in quality measure five star rating': 0, 'measure period': 0, 'location': 0, 'processing date': 0}
2025-02-12 22:18:03,657 - INFO - Computed summary statistics.
2025-02-12 22:18:03,658 - INFO - Prepared data saved to ./data/processed/NH_QualityMsr_MDS_Jan2025.csv
2025-02-12 22:18:03,664 - INFO - Successfully processed dataset: nh_quality_mds
2025-02-12 22:18:03,954 - INFO - Data loaded from ./data/raw/NH_Ownership_Jan2025.csv with shape (144651, 13).
2025-02-12 22:18:03,954 - INFO - Column names standardized.
2025-02-12 22:18:04,081 - INFO - Dropped duplicates: shape changed from (144651, 13) to (144651, 13).
2025-02-12 22:18:04,124 - INFO - Missing values before handling: {'cms certification number (ccn)': 0, 'provider name': 0, 'provider address': 0, 'city/town': 0, 'state': 0, 'zip code': 0, 'role played by owner or manager in facility': 0, 'owner type': 595, 'owner name': 595, 'ownership percentage': 595, 'association date': 595, 'location': 0, 'processing date': 0}
2025-02-12 22:18:04,183 - INFO - Dropped rows with missing values.
2025-02-12 22:18:04,226 - INFO - Missing values after handling: {'cms certification number (ccn)': 0, 'provider name': 0, 'provider address': 0, 'city/town': 0, 'state': 0, 'zip code': 0, 'role played by owner or manager in facility': 0, 'owner type': 0, 'owner name': 0, 'ownership percentage': 0, 'association date': 0, 'location': 0, 'processing date': 0}
2025-02-12 22:18:04,231 - INFO - Computed summary statistics.
2025-02-12 22:18:04,894 - INFO - Prepared data saved to ./data/processed/NH_Ownership_Jan2025.csv
2025-02-12 22:18:04,897 - INFO - Successfully processed dataset: nh_ownership
2025-02-12 22:18:06,450 - INFO - Data loaded from ./data/raw/NH_HealthCitations_Jan2025.csv with shape (406789, 23).
2025-02-12 22:18:06,450 - INFO - Column names standardized.
2025-02-12 22:18:06,983 - INFO - Dropped duplicates: shape changed from (406789, 23) to (406789, 23).
2025-02-12 22:18:07,179 - INFO - Missing values before handling: {'cms certification number (ccn)': 0, 'provider name': 0, 'provider address': 0, 'city/town': 0, 'state': 0, 'zip code': 0, 'survey date': 0, 'survey type': 0, 'deficiency prefix': 0, 'deficiency category': 0, 'deficiency tag number': 0, 'deficiency description': 0, 'scope severity code': 0, 'deficiency corrected': 0, 'correction date': 1392, 'inspection cycle': 0, 'standard deficiency': 0, 'complaint deficiency': 0, 'infection control inspection deficiency': 0, 'citation under idr': 0, 'citation under iidr': 0, 'location': 0, 'processing date': 0}
2025-02-12 22:18:07,427 - INFO - Dropped rows with missing values.
2025-02-12 22:18:07,622 - INFO - Missing values after handling: {'cms certification number (ccn)': 0, 'provider name': 0, 'provider address': 0, 'city/town': 0, 'state': 0, 'zip code': 0, 'survey date': 0, 'survey type': 0, 'deficiency prefix': 0, 'deficiency category': 0, 'deficiency tag number': 0, 'deficiency description': 0, 'scope severity code': 0, 'deficiency corrected': 0, 'correction date': 0, 'inspection cycle': 0, 'standard deficiency': 0, 'complaint deficiency': 0, 'infection control inspection deficiency': 0, 'citation under idr': 0, 'citation under iidr': 0, 'location': 0, 'processing date': 0}
2025-02-12 22:18:07,647 - INFO - Computed summary statistics.
2025-02-12 22:18:10,905 - INFO - Prepared data saved to ./data/processed/NH_HealthCitations_Jan2025.csv
2025-02-12 22:18:10,917 - INFO - Successfully processed dataset: nh_citations
2025-02-12 22:27:49,678 - INFO - Starting Prepare Phase Script
2025-02-12 22:28:08,367 - INFO - pbj_nurse loaded with shape (1325324, 33)
2025-02-12 22:28:08,367 - INFO - pbj_non_nurse loaded with shape (1325324, 82)
2025-02-12 22:28:08,368 - INFO - qrp_provider loaded with shape (710016, 16)
2025-02-12 22:28:08,368 - INFO - nh_survey loaded with shape (44189, 41)
2025-02-12 22:28:08,368 - INFO - nh_quality_mds loaded with shape (251464, 23)
2025-02-12 22:28:08,368 - INFO - nh_ownership loaded with shape (144651, 13)
2025-02-12 22:28:08,368 - INFO - nh_citations loaded with shape (406789, 23)
2025-02-12 22:28:24,679 - INFO - Processed dataset saved: ./data/processed/processed_pbj_nurse.csv
2025-02-12 22:29:04,647 - INFO - Processed dataset saved: ./data/processed/processed_pbj_non_nurse.csv
2025-02-12 22:29:07,896 - INFO - Processed dataset saved: ./data/processed/processed_qrp_provider.csv
2025-02-12 22:29:08,426 - INFO - Processed dataset saved: ./data/processed/processed_nh_survey.csv
2025-02-12 22:29:10,718 - INFO - Processed dataset saved: ./data/processed/processed_nh_quality_mds.csv
2025-02-12 22:29:11,378 - INFO - Processed dataset saved: ./data/processed/processed_nh_ownership.csv
2025-02-12 22:29:14,703 - INFO - Processed dataset saved: ./data/processed/processed_nh_citations.csv
2025-02-12 22:30:28,911 - INFO - Starting Prepare Phase Script
2025-02-12 22:30:47,761 - INFO - pbj_nurse loaded with shape (1325324, 33)
2025-02-12 22:30:47,761 - INFO - pbj_non_nurse loaded with shape (1325324, 82)
2025-02-12 22:30:47,761 - INFO - qrp_provider loaded with shape (710016, 16)
2025-02-12 22:30:47,761 - INFO - nh_survey loaded with shape (44189, 41)
2025-02-12 22:30:47,761 - INFO - nh_quality_mds loaded with shape (251464, 23)
2025-02-12 22:30:47,762 - INFO - nh_ownership loaded with shape (144651, 13)
2025-02-12 22:30:47,762 - INFO - nh_citations loaded with shape (406789, 23)
2025-02-12 22:31:03,877 - INFO - Preprocessed dataset saved: ./data/interim/preprocessed_pbj_nurse.csv
2025-02-12 22:31:43,380 - INFO - Preprocessed dataset saved: ./data/interim/preprocessed_pbj_non_nurse.csv
2025-02-12 22:31:46,574 - INFO - Preprocessed dataset saved: ./data/interim/preprocessed_qrp_provider.csv
2025-02-12 22:31:47,107 - INFO - Preprocessed dataset saved: ./data/interim/preprocessed_nh_survey.csv
2025-02-12 22:31:49,359 - INFO - Preprocessed dataset saved: ./data/interim/preprocessed_nh_quality_mds.csv
2025-02-12 22:31:50,005 - INFO - Preprocessed dataset saved: ./data/interim/preprocessed_nh_ownership.csv
2025-02-12 22:31:53,217 - INFO - Preprocessed dataset saved: ./data/interim/preprocessed_nh_citations.csv
2025-02-12 22:34:55,136 - INFO - Starting Prepare Phase Script
2025-02-12 22:35:14,933 - INFO - pbj_nurse loaded with shape (1325324, 33)
2025-02-12 22:35:14,933 - INFO - pbj_non_nurse loaded with shape (1325324, 82)
2025-02-12 22:35:14,934 - INFO - qrp_provider loaded with shape (710016, 16)
2025-02-12 22:35:14,934 - INFO - nh_survey loaded with shape (44189, 41)
2025-02-12 22:35:14,934 - INFO - nh_quality_mds loaded with shape (251464, 23)
2025-02-12 22:35:14,934 - INFO - nh_ownership loaded with shape (144651, 13)
2025-02-12 22:35:14,934 - INFO - nh_citations loaded with shape (406789, 23)
2025-02-12 22:35:16,412 - INFO - Preprocessed dataset saved: ./data/interim/preprocessed_pbj_nurse.parquet
2025-02-12 22:35:18,611 - INFO - Preprocessed dataset saved: ./data/interim/preprocessed_pbj_non_nurse.parquet
2025-02-12 22:35:19,485 - INFO - Preprocessed dataset saved: ./data/interim/preprocessed_qrp_provider.parquet
2025-02-12 22:35:19,565 - INFO - Preprocessed dataset saved: ./data/interim/preprocessed_nh_survey.parquet
2025-02-12 22:35:19,897 - INFO - Preprocessed dataset saved: ./data/interim/preprocessed_nh_quality_mds.parquet
2025-02-12 22:35:20,080 - INFO - Preprocessed dataset saved: ./data/interim/preprocessed_nh_ownership.parquet
2025-02-12 22:35:20,811 - INFO - Preprocessed dataset saved: ./data/interim/preprocessed_nh_citations.parquet
