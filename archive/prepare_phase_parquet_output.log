2025-02-12 22:59:47,684 - INFO - === Prepare Phase Notebook: Logging Setup Complete ===
2025-02-12 22:59:47,684 - INFO - Using PARQUET_PATH: ./data/interim/
2025-02-12 22:59:47,684 - INFO - Logs will be written to: prepare_phase_parquet_output.log
2025-02-12 23:00:04,892 - INFO - === Starting Prepare Phase (Parquet Version) ===
2025-02-12 23:00:05,240 - INFO - Loaded 'pbj_nurse' from ./data/interim/preprocessed_pbj_nurse.parquet. Shape: (1325324, 33)
2025-02-12 23:00:05,560 - INFO - Loaded 'pbj_non_nurse' from ./data/interim/preprocessed_pbj_non_nurse.parquet. Shape: (1325324, 82)
2025-02-12 23:00:05,894 - INFO - Loaded 'qrp_provider' from ./data/interim/preprocessed_qrp_provider.parquet. Shape: (710016, 16)
2025-02-12 23:00:05,922 - INFO - Loaded 'nh_survey' from ./data/interim/preprocessed_nh_survey.parquet. Shape: (44189, 41)
2025-02-12 23:00:06,034 - INFO - Loaded 'nh_quality_mds' from ./data/interim/preprocessed_nh_quality_mds.parquet. Shape: (251464, 23)
2025-02-12 23:00:06,115 - INFO - Loaded 'nh_ownership' from ./data/interim/preprocessed_nh_ownership.parquet. Shape: (144651, 13)
2025-02-12 23:00:06,400 - INFO - Loaded 'nh_citations' from ./data/interim/preprocessed_nh_citations.parquet. Shape: (406789, 23)
2025-02-12 23:00:06,400 - INFO - === Summary of Loaded Datasets ===
2025-02-12 23:00:06,400 - INFO - pbj_nurse: shape=(1325324, 33), columns=['PROVNUM', 'PROVNAME', 'CITY', 'STATE', 'COUNTY_NAME', 'COUNTY_FIPS', 'CY_Qtr', 'WorkDate', 'MDScensus', 'Hrs_RNDON', 'Hrs_RNDON_emp', 'Hrs_RNDON_ctr', 'Hrs_RNadmin', 'Hrs_RNadmin_emp', 'Hrs_RNadmin_ctr', 'Hrs_RN', 'Hrs_RN_emp', 'Hrs_RN_ctr', 'Hrs_LPNadmin', 'Hrs_LPNadmin_emp', 'Hrs_LPNadmin_ctr', 'Hrs_LPN', 'Hrs_LPN_emp', 'Hrs_LPN_ctr', 'Hrs_CNA', 'Hrs_CNA_emp', 'Hrs_CNA_ctr', 'Hrs_NAtrn', 'Hrs_NAtrn_emp', 'Hrs_NAtrn_ctr', 'Hrs_MedAide', 'Hrs_MedAide_emp', 'Hrs_MedAide_ctr']
2025-02-12 23:00:06,400 - INFO - pbj_non_nurse: shape=(1325324, 82), columns=['PROVNUM', 'PROVNAME', 'CITY', 'STATE', 'COUNTY_NAME', 'COUNTY_FIPS', 'CY_Qtr', 'WorkDate', 'MDScensus', 'Hrs_Admin', 'Hrs_Admin_emp', 'Hrs_Admin_ctr', 'Hrs_Admin_fn', 'Hrs_MedDir', 'Hrs_MedDir_emp', 'Hrs_MedDir_ctr', 'Hrs_OthMD', 'Hrs_OthMD_emp', 'Hrs_OthMD_ctr', 'Hrs_PA', 'Hrs_PA_emp', 'Hrs_PA_ctr', 'Hrs_NP', 'Hrs_NP_emp', 'Hrs_NP_ctr', 'Hrs_ClinNrsSpec', 'Hrs_ClinNrsSpec_emp', 'Hrs_ClinNrsSpec_ctr', 'Hrs_Pharmacist', 'Hrs_Pharmacist_emp', 'Hrs_Pharmacist_ctr', 'Hrs_Dietician', 'Hrs_Dietician_emp', 'Hrs_Dietician_ctr', 'Hrs_FeedAsst', 'Hrs_FeedAsst_emp', 'Hrs_FeedAsst_ctr', 'Hrs_OT', 'Hrs_OT_emp', 'Hrs_OT_ctr', 'Hrs_OTasst', 'Hrs_OTasst_emp', 'Hrs_OTasst_ctr', 'Hrs_OTaide', 'Hrs_OTaide_emp', 'Hrs_OTaide_ctr', 'Hrs_PT', 'Hrs_PT_emp', 'Hrs_PT_ctr', 'Hrs_PTasst', 'Hrs_PTasst_emp', 'Hrs_PTasst_ctr', 'Hrs_PTaide', 'Hrs_PTaide_emp', 'Hrs_PTaide_ctr', 'Hrs_RespTher', 'Hrs_RespTher_emp', 'Hrs_RespTher_ctr', 'Hrs_RespTech', 'Hrs_RespTech_emp', 'Hrs_RespTech_ctr', 'Hrs_SpcLangPath', 'Hrs_SpcLangPath_emp', 'Hrs_SpcLangPath_ctr', 'Hrs_TherRecSpec', 'Hrs_TherRecSpec_emp', 'Hrs_TherRecSpec_ctr', 'Hrs_QualActvProf', 'Hrs_QualActvProf_emp', 'Hrs_QualActvProf_ctr', 'Hrs_OthActv', 'Hrs_OthActv_emp', 'Hrs_OthActv_ctr', 'Hrs_QualSocWrk', 'Hrs_QualSocWrk_emp', 'Hrs_QualSocWrk_ctr', 'Hrs_OthSocWrk', 'Hrs_OthSocWrk_emp', 'Hrs_OthSocWrk_ctr', 'Hrs_MHSvc', 'Hrs_MHSvc_emp', 'Hrs_MHSvc_ctr']
2025-02-12 23:00:06,401 - INFO - qrp_provider: shape=(710016, 16), columns=['CMS Certification Number (CCN)', 'Provider Name', 'Address Line 1', 'City/Town', 'State', 'ZIP Code', 'County/Parish', 'Telephone Number', 'CMS Region', 'Measure Code', 'Score', 'Footnote', 'Start Date', 'End Date', 'Measure Date Range', 'LOCATION1']
2025-02-12 23:00:06,401 - INFO - nh_survey: shape=(44189, 41), columns=['CMS Certification Number (CCN)', 'Provider Name', 'Provider Address', 'City/Town', 'State', 'ZIP Code', 'Inspection Cycle', 'Health Survey Date', 'Fire Safety Survey Date', 'Total Number of Health Deficiencies', 'Total Number of Fire Safety Deficiencies', 'Count of Freedom from Abuse and Neglect and Exploitation Deficiencies', 'Count of Quality of Life and Care Deficiencies', 'Count of Resident Assessment and Care Planning Deficiencies', 'Count of Nursing and Physician Services Deficiencies', 'Count of Resident Rights Deficiencies', 'Count of Nutrition and Dietary Deficiencies', 'Count of Pharmacy Service Deficiencies', 'Count of Environmental Deficiencies', 'Count of Administration Deficiencies', 'Count of Infection Control Deficiencies', 'Count of Emergency Preparedness Deficiencies', 'Count of Automatic Sprinkler Systems Deficiencies', 'Count of Construction Deficiencies', 'Count of Services Deficiencies', 'Count of Corridor Walls and Doors Deficiencies', 'Count of Egress Deficiencies', 'Count of Electrical Deficiencies', 'Count of Emergency Plans and Fire Drills Deficiencies', 'Count of Fire Alarm Systems Deficiencies', 'Count of Smoke Deficiencies', 'Count of Interior Deficiencies', 'Count of Gas and Vacuum and Electrical Systems Deficiencies', 'Count of Hazardous Area Deficiencies', 'Count of Illumination and Emergency Power Deficiencies', 'Count of Laboratories Deficiencies', 'Count of Medical Gases and Anaesthetizing Areas Deficiencies', 'Count of Smoking Regulations Deficiencies', 'Count of Miscellaneous Deficiencies', 'Location', 'Processing Date']
2025-02-12 23:00:06,401 - INFO - nh_quality_mds: shape=(251464, 23), columns=['CMS Certification Number (CCN)', 'Provider Name', 'Provider Address', 'City/Town', 'State', 'ZIP Code', 'Measure Code', 'Measure Description', 'Resident type', 'Q1 Measure Score', 'Footnote for Q1 Measure Score', 'Q2 Measure Score', 'Footnote for Q2 Measure Score', 'Q3 Measure Score', 'Footnote for Q3 Measure Score', 'Q4 Measure Score', 'Footnote for Q4 Measure Score', 'Four Quarter Average Score', 'Footnote for Four Quarter Average Score', 'Used in Quality Measure Five Star Rating', 'Measure Period', 'Location', 'Processing Date']
2025-02-12 23:00:06,401 - INFO - nh_ownership: shape=(144651, 13), columns=['CMS Certification Number (CCN)', 'Provider Name', 'Provider Address', 'City/Town', 'State', 'ZIP Code', 'Role played by Owner or Manager in Facility', 'Owner Type', 'Owner Name', 'Ownership Percentage', 'Association Date', 'Location', 'Processing Date']
2025-02-12 23:00:06,401 - INFO - nh_citations: shape=(406789, 23), columns=['CMS Certification Number (CCN)', 'Provider Name', 'Provider Address', 'City/Town', 'State', 'ZIP Code', 'Survey Date', 'Survey Type', 'Deficiency Prefix', 'Deficiency Category', 'Deficiency Tag Number', 'Deficiency Description', 'Scope Severity Code', 'Deficiency Corrected', 'Correction Date', 'Inspection Cycle', 'Standard Deficiency', 'Complaint Deficiency', 'Infection Control Inspection Deficiency', 'Citation under IDR', 'Citation under IIDR', 'Location', 'Processing Date']
2025-02-12 23:00:06,401 - INFO - === Prepare Phase (Parquet) - Load Step Completed ===
2025-02-12 23:00:33,885 - INFO - === Data Quality Checks for pbj_nurse ===
2025-02-12 23:00:34,129 - INFO - Missing Value Counts per Column:
2025-02-12 23:00:34,129 - INFO - PROVNUM             0
PROVNAME            0
CITY                0
STATE               0
COUNTY_NAME         0
COUNTY_FIPS         0
CY_Qtr              0
WorkDate            0
MDScensus           0
Hrs_RNDON           0
Hrs_RNDON_emp       0
Hrs_RNDON_ctr       0
Hrs_RNadmin         0
Hrs_RNadmin_emp     0
Hrs_RNadmin_ctr     0
Hrs_RN              0
Hrs_RN_emp          0
Hrs_RN_ctr          0
Hrs_LPNadmin        0
Hrs_LPNadmin_emp    0
Hrs_LPNadmin_ctr    0
Hrs_LPN             0
Hrs_LPN_emp         0
Hrs_LPN_ctr         0
Hrs_CNA             0
Hrs_CNA_emp         0
Hrs_CNA_ctr         0
Hrs_NAtrn           0
Hrs_NAtrn_emp       0
Hrs_NAtrn_ctr       0
Hrs_MedAide         0
Hrs_MedAide_emp     0
Hrs_MedAide_ctr     0
dtype: int64
2025-02-12 23:00:35,347 - INFO - Number of Duplicate Rows: 0
2025-02-12 23:00:36,461 - INFO - Basic Stats for Numeric Columns:
2025-02-12 23:00:36,470 - INFO - COUNTY_FIPS      WorkDate     MDScensus     Hrs_RNDON  Hrs_RNDON_emp  \
count  1.325324e+06  1.325324e+06  1.325324e+06  1.325324e+06   1.325324e+06   
mean   9.113430e+01  2.024052e+07  8.341670e+01  5.195887e+00   5.099312e+00   
std    9.912806e+01  8.167078e+01  4.904109e+01  4.389664e+00   4.382255e+00   
min    1.000000e+00  2.024040e+07  0.000000e+00  0.000000e+00   0.000000e+00   
25%    3.100000e+01  2.024042e+07  5.100000e+01  0.000000e+00   0.000000e+00   
50%    6.900000e+01  2.024052e+07  7.600000e+01  8.000000e+00   8.000000e+00   
75%    1.170000e+02  2.024061e+07  1.040000e+02  8.000000e+00   8.000000e+00   
max    8.400000e+02  2.024063e+07  7.420000e+02  1.039600e+02   1.039600e+02   

       Hrs_RNDON_ctr   Hrs_RNadmin  Hrs_RNadmin_emp  Hrs_RNadmin_ctr  \
count   1.325324e+06  1.325324e+06     1.325324e+06     1.325324e+06   
mean    9.657448e-02  1.026275e+01     1.001164e+01     2.511122e-01   
std     9.182349e-01  1.476875e+01     1.455953e+01     1.845270e+00   
min     0.000000e+00  0.000000e+00     0.000000e+00     0.000000e+00   
25%     0.000000e+00  0.000000e+00     0.000000e+00     0.000000e+00   
50%     0.000000e+00  7.500000e+00     7.500000e+00     0.000000e+00   
75%     0.000000e+00  1.600000e+01     1.600000e+01     0.000000e+00   
max     2.575000e+01  2.755000e+02     2.755000e+02     8.725000e+01   

             Hrs_RN  ...   Hrs_LPN_ctr       Hrs_CNA   Hrs_CNA_emp  \
count  1.325324e+06  ...  1.325324e+06  1.325324e+06  1.325324e+06   
mean   3.480192e+01  ...  6.133439e+00  1.737908e+02  1.616093e+02   
std    3.532269e+01  ...  1.963754e+01  1.151591e+02  1.081243e+02   
min    0.000000e+00  ...  0.000000e+00  0.000000e+00  0.000000e+00   
25%    1.325000e+01  ...  0.000000e+00  9.857000e+01  9.025000e+01   
50%    2.575000e+01  ...  0.000000e+00  1.506200e+02  1.400000e+02   
75%    4.525000e+01  ...  4.000000e+00  2.200000e+02  2.074800e+02   
max    9.159800e+02  ...  1.380150e+04  1.758100e+03  1.503630e+03   

        Hrs_CNA_ctr     Hrs_NAtrn  Hrs_NAtrn_emp  Hrs_NAtrn_ctr   Hrs_MedAide  \
count  1.325324e+06  1.325324e+06   1.325324e+06   1.325324e+06  1.325324e+06   
mean   1.218150e+01  4.314155e+00   4.262067e+00   5.208815e-02  8.578327e+00   
std    3.184142e+01  1.336067e+01   1.302080e+01   2.011555e+00  1.785970e+01   
min    0.000000e+00  0.000000e+00   0.000000e+00   0.000000e+00  0.000000e+00   
25%    0.000000e+00  0.000000e+00   0.000000e+00   0.000000e+00  0.000000e+00   
50%    0.000000e+00  0.000000e+00   0.000000e+00   0.000000e+00  0.000000e+00   
75%    8.000000e+00  0.000000e+00   0.000000e+00   0.000000e+00  1.131000e+01   
max    6.614200e+02  4.437500e+02   4.387500e+02   2.470000e+02  4.298000e+02   

       Hrs_MedAide_emp  Hrs_MedAide_ctr  
count     1.325324e+06     1.325324e+06  
mean      8.363303e+00     2.150232e-01  
std       1.749784e+01     2.104964e+00  
min       0.000000e+00     0.000000e+00  
25%       0.000000e+00     0.000000e+00  
50%       0.000000e+00     0.000000e+00  
75%       1.087000e+01     0.000000e+00  
max       4.298000e+02     8.775000e+01  

[8 rows x 27 columns]
2025-02-12 23:00:36,470 - INFO - === Data Quality Checks for pbj_non_nurse ===
2025-02-12 23:00:36,784 - INFO - Missing Value Counts per Column:
2025-02-12 23:00:36,785 - INFO - PROVNUM              0
PROVNAME             0
CITY                 0
STATE                0
COUNTY_NAME          0
                    ..
Hrs_OthSocWrk_emp    0
Hrs_OthSocWrk_ctr    0
Hrs_MHSvc            0
Hrs_MHSvc_emp        0
Hrs_MHSvc_ctr        0
Length: 82, dtype: int64
2025-02-12 23:00:39,014 - INFO - Number of Duplicate Rows: 0
2025-02-12 23:00:41,810 - INFO - Basic Stats for Numeric Columns:
2025-02-12 23:00:41,816 - INFO - COUNTY_FIPS      WorkDate     MDScensus     Hrs_Admin  Hrs_Admin_emp  \
count  1.325324e+06  1.325324e+06  1.325324e+06  1.319227e+06   1.319227e+06   
mean   9.113430e+01  2.024052e+07  8.341670e+01  5.415150e+00   5.282056e+00   
std    9.912806e+01  8.167078e+01  4.904109e+01  4.642567e+00   4.643081e+00   
min    1.000000e+00  2.024040e+07  0.000000e+00  0.000000e+00   0.000000e+00   
25%    3.100000e+01  2.024042e+07  5.100000e+01  0.000000e+00   0.000000e+00   
50%    6.900000e+01  2.024052e+07  7.600000e+01  8.000000e+00   8.000000e+00   
75%    1.170000e+02  2.024061e+07  1.040000e+02  8.000000e+00   8.000000e+00   
max    8.400000e+02  2.024063e+07  7.420000e+02  6.800000e+01   4.525000e+01   

       Hrs_Admin_ctr  Hrs_Admin_fn    Hrs_MedDir  Hrs_MedDir_emp  \
count   1.319227e+06        6097.0  1.325324e+06    1.325324e+06   
mean    1.330937e-01           1.0  3.762991e-01    7.830458e-02   
std     1.072293e+00           0.0  1.460066e+00    7.513089e-01   
min     0.000000e+00           1.0  0.000000e+00    0.000000e+00   
25%     0.000000e+00           1.0  0.000000e+00    0.000000e+00   
50%     0.000000e+00           1.0  0.000000e+00    0.000000e+00   
75%     0.000000e+00           1.0  0.000000e+00    0.000000e+00   
max     6.800000e+01           1.0  6.125000e+01    6.125000e+01   

       Hrs_MedDir_ctr  ...  Hrs_OthActv_ctr  Hrs_QualSocWrk  \
count    1.325324e+06  ...     1.325324e+06    1.325324e+06   
mean     2.979946e-01  ...     1.181517e-01    4.373406e+00   
std      1.259352e+00  ...     2.033839e+00    6.575853e+00   
min      0.000000e+00  ...     0.000000e+00    0.000000e+00   
25%      0.000000e+00  ...     0.000000e+00    0.000000e+00   
50%      0.000000e+00  ...     0.000000e+00    0.000000e+00   
75%      0.000000e+00  ...     0.000000e+00    8.000000e+00   
max      3.900000e+01  ...     1.092500e+02    9.075000e+01   

       Hrs_QualSocWrk_emp  Hrs_QualSocWrk_ctr  Hrs_OthSocWrk  \
count        1.325324e+06        1.325324e+06   1.325324e+06   
mean         4.342660e+00        3.074557e-02   3.107487e+00   
std          6.537645e+00        5.176069e-01   6.729960e+00   
min          0.000000e+00        0.000000e+00   0.000000e+00   
25%          0.000000e+00        0.000000e+00   0.000000e+00   
50%          0.000000e+00        0.000000e+00   0.000000e+00   
75%          8.000000e+00        0.000000e+00   5.960000e+00   
max          9.075000e+01        3.180000e+01   2.007800e+02   

       Hrs_OthSocWrk_emp  Hrs_OthSocWrk_ctr     Hrs_MHSvc  Hrs_MHSvc_emp  \
count       1.325324e+06       1.325324e+06  1.325324e+06   1.325324e+06   
mean        3.091622e+00       1.586563e-02  3.314399e-01   3.030647e-01   
std         6.698340e+00       6.564691e-01  4.929164e+00   4.847544e+00   
min         0.000000e+00       0.000000e+00  0.000000e+00   0.000000e+00   
25%         0.000000e+00       0.000000e+00  0.000000e+00   0.000000e+00   
50%         0.000000e+00       0.000000e+00  0.000000e+00   0.000000e+00   
75%         5.770000e+00       0.000000e+00  0.000000e+00   0.000000e+00   
max         2.007800e+02       1.010000e+02  3.942700e+02   3.872700e+02   

       Hrs_MHSvc_ctr  
count   1.325324e+06  
mean    2.837520e-02  
std     4.830650e-01  
min     0.000000e+00  
25%     0.000000e+00  
50%     0.000000e+00  
75%     0.000000e+00  
max     4.100000e+01  

[8 rows x 76 columns]
2025-02-12 23:00:41,816 - INFO - === Data Quality Checks for qrp_provider ===
2025-02-12 23:00:42,058 - INFO - Missing Value Counts per Column:
2025-02-12 23:00:42,059 - INFO - CMS Certification Number (CCN)    0
Provider Name                     0
Address Line 1                    0
City/Town                         0
State                             0
ZIP Code                          0
County/Parish                     0
Telephone Number                  0
CMS Region                        0
Measure Code                      0
Score                             0
Footnote                          0
Start Date                        0
End Date                          0
Measure Date Range                0
LOCATION1                         0
dtype: int64
2025-02-12 23:00:42,605 - INFO - Number of Duplicate Rows: 0
2025-02-12 23:00:42,635 - INFO - Basic Stats for Numeric Columns:
2025-02-12 23:00:42,636 - INFO - ZIP Code     CMS Region
count  710016.000000  710016.000000
mean    50343.823486       5.190576
std     26875.286236       2.249510
min       660.000000       1.000000
25%     29732.000000       4.000000
50%     48519.000000       5.000000
75%     73045.750000       7.000000
max     99929.000000      10.000000
2025-02-12 23:00:42,636 - INFO - === Data Quality Checks for nh_survey ===
2025-02-12 23:00:42,647 - INFO - Missing Value Counts per Column:
2025-02-12 23:00:42,648 - INFO - CMS Certification Number (CCN)                                            0
Provider Name                                                             0
Provider Address                                                          0
City/Town                                                                 0
State                                                                     0
ZIP Code                                                                  0
Inspection Cycle                                                          0
Health Survey Date                                                        0
Fire Safety Survey Date                                                  33
Total Number of Health Deficiencies                                       0
Total Number of Fire Safety Deficiencies                                 33
Count of Freedom from Abuse and Neglect and Exploitation Deficiencies     0
Count of Quality of Life and Care Deficiencies                            0
Count of Resident Assessment and Care Planning Deficiencies               0
Count of Nursing and Physician Services Deficiencies                      0
Count of Resident Rights Deficiencies                                     0
Count of Nutrition and Dietary Deficiencies                               0
Count of Pharmacy Service Deficiencies                                    0
Count of Environmental Deficiencies                                       0
Count of Administration Deficiencies                                      0
Count of Infection Control Deficiencies                                   0
Count of Emergency Preparedness Deficiencies                             33
Count of Automatic Sprinkler Systems Deficiencies                        33
Count of Construction Deficiencies                                       33
Count of Services Deficiencies                                           33
Count of Corridor Walls and Doors Deficiencies                           33
Count of Egress Deficiencies                                             33
Count of Electrical Deficiencies                                         33
Count of Emergency Plans and Fire Drills Deficiencies                    33
Count of Fire Alarm Systems Deficiencies                                 33
Count of Smoke Deficiencies                                              33
Count of Interior Deficiencies                                           33
Count of Gas and Vacuum and Electrical Systems Deficiencies              33
Count of Hazardous Area Deficiencies                                     33
Count of Illumination and Emergency Power Deficiencies                   33
Count of Laboratories Deficiencies                                       33
Count of Medical Gases and Anaesthetizing Areas Deficiencies             33
Count of Smoking Regulations Deficiencies                                33
Count of Miscellaneous Deficiencies                                      33
Location                                                                  0
Processing Date                                                           0
dtype: int64
2025-02-12 23:00:42,691 - INFO - Number of Duplicate Rows: 0
2025-02-12 23:00:42,744 - INFO - Basic Stats for Numeric Columns:
2025-02-12 23:00:42,749 - INFO - ZIP Code  Inspection Cycle  Total Number of Health Deficiencies  \
count  44189.000000      44189.000000                         44189.000000   
mean   50339.324809          1.997013                             7.014710   
std    26891.348600          0.816399                             6.023656   
min      660.000000          1.000000                             0.000000   
25%    29720.000000          1.000000                             3.000000   
50%    48602.000000          2.000000                             6.000000   
75%    73049.000000          3.000000                            10.000000   
max    99929.000000          3.000000                            70.000000   

       Total Number of Fire Safety Deficiencies  \
count                              44156.000000   
mean                                   4.520405   
std                                    4.572814   
min                                    0.000000   
25%                                    1.000000   
50%                                    3.000000   
75%                                    7.000000   
max                                   44.000000   

       Count of Freedom from Abuse and Neglect and Exploitation Deficiencies  \
count                                       44189.000000                       
mean                                            0.283306                       
std                                             0.698449                       
min                                             0.000000                       
25%                                             0.000000                       
50%                                             0.000000                       
75%                                             0.000000                       
max                                             7.000000                       

       Count of Quality of Life and Care Deficiencies  \
count                                    44189.000000   
mean                                         1.755301   
std                                          1.912846   
min                                          0.000000   
25%                                          0.000000   
50%                                          1.000000   
75%                                          3.000000   
max                                         19.000000   

       Count of Resident Assessment and Care Planning Deficiencies  \
count                                       44189.000000             
mean                                            1.096359             
std                                             1.333293             
min                                             0.000000             
25%                                             0.000000             
50%                                             1.000000             
75%                                             2.000000             
max                                            11.000000             

       Count of Nursing and Physician Services Deficiencies  \
count                                       44189.000000      
mean                                            0.249270      
std                                             0.588568      
min                                             0.000000      
25%                                             0.000000      
50%                                             0.000000      
75%                                             0.000000      
max                                             8.000000      

       Count of Resident Rights Deficiencies  \
count                           44189.000000   
mean                                1.066442   
std                                 1.423154   
min                                 0.000000   
25%                                 0.000000   
50%                                 1.000000   
75%                                 2.000000   
max                                17.000000   

       Count of Nutrition and Dietary Deficiencies  ...  \
count                                 44189.000000  ...   
mean                                      0.732943  ...   
std                                       0.995185  ...   
min                                       0.000000  ...   
25%                                       0.000000  ...   
50%                                       0.000000  ...   
75%                                       1.000000  ...   
max                                      11.000000  ...   

       Count of Fire Alarm Systems Deficiencies  Count of Smoke Deficiencies  \
count                                   44156.0                 44156.000000   
mean                                        0.0                     1.759987   
std                                         0.0                     1.835830   
min                                         0.0                     0.000000   
25%                                         0.0                     0.000000   
50%                                         0.0                     1.000000   
75%                                         0.0                     3.000000   
max                                         0.0                    13.000000   

       Count of Interior Deficiencies  \
count                    44156.000000   
mean                         0.000045   
std                          0.006730   
min                          0.000000   
25%                          0.000000   
50%                          0.000000   
75%                          0.000000   
max                          1.000000   

       Count of Gas and Vacuum and Electrical Systems Deficiencies  \
count                                       44156.000000             
mean                                            0.814340             
std                                             1.050809             
min                                             0.000000             
25%                                             0.000000             
50%                                             0.000000             
75%                                             1.000000             
max                                             8.000000             

       Count of Hazardous Area Deficiencies  \
count                          44156.000000   
mean                               0.000023   
std                                0.004759   
min                                0.000000   
25%                                0.000000   
50%                                0.000000   
75%                                0.000000   
max                                1.000000   

       Count of Illumination and Emergency Power Deficiencies  \
count                                       44156.000000        
mean                                            0.000023        
std                                             0.004759        
min                                             0.000000        
25%                                             0.000000        
50%                                             0.000000        
75%                                             0.000000        
max                                             1.000000        

       Count of Laboratories Deficiencies  \
count                             44156.0   
mean                                  0.0   
std                                   0.0   
min                                   0.0   
25%                                   0.0   
50%                                   0.0   
75%                                   0.0   
max                                   0.0   

       Count of Medical Gases and Anaesthetizing Areas Deficiencies  \
count                                       44156.000000              
mean                                            0.000045              
std                                             0.006730              
min                                             0.000000              
25%                                             0.000000              
50%                                             0.000000              
75%                                             0.000000              
max                                             1.000000              

       Count of Smoking Regulations Deficiencies  \
count                                    44156.0   
mean                                         0.0   
std                                          0.0   
min                                          0.0   
25%                                          0.0   
50%                                          0.0   
75%                                          0.0   
max                                          0.0   

       Count of Miscellaneous Deficiencies  
count                         44156.000000  
mean                              0.466800  
std                               0.766179  
min                               0.000000  
25%                               0.000000  
50%                               0.000000  
75%                               1.000000  
max                               7.000000  

[8 rows x 32 columns]
2025-02-12 23:00:42,749 - INFO - === Data Quality Checks for nh_quality_mds ===
2025-02-12 23:00:42,821 - INFO - Missing Value Counts per Column:
2025-02-12 23:00:42,821 - INFO - CMS Certification Number (CCN)                   0
Provider Name                                    0
Provider Address                                 0
City/Town                                        0
State                                            0
ZIP Code                                         0
Measure Code                                     0
Measure Description                              0
Resident type                                    0
Q1 Measure Score                             64416
Footnote for Q1 Measure Score               187048
Q2 Measure Score                             30096
Footnote for Q2 Measure Score               221368
Q3 Measure Score                             29209
Footnote for Q3 Measure Score               222255
Q4 Measure Score                             28945
Footnote for Q4 Measure Score               222519
Four Quarter Average Score                    8775
Footnote for Four Quarter Average Score     242689
Used in Quality Measure Five Star Rating         0
Measure Period                                   0
Location                                         0
Processing Date                                  0
dtype: int64
2025-02-12 23:00:43,064 - INFO - Number of Duplicate Rows: 0
2025-02-12 23:00:43,188 - INFO - Basic Stats for Numeric Columns:
2025-02-12 23:00:43,191 - INFO - ZIP Code   Measure Code  Q1 Measure Score  \
count  251464.000000  251464.000000     187048.000000   
mean    50343.823486     431.235294         29.152946   
std     26875.320747      27.061051         38.566512   
min       660.000000     401.000000          0.000000   
25%     29732.000000     408.000000          0.964827   
50%     48519.000000     419.000000          6.583004   
75%     73045.750000     452.000000         64.814815   
max     99929.000000     480.000000        100.000000   

       Footnote for Q1 Measure Score  Q2 Measure Score  \
count                   64416.000000     221368.000000   
mean                        9.057004         28.301362   
std                         0.740011         36.190215   
min                         9.000000          0.000000   
25%                         9.000000          1.754386   
50%                         9.000000          9.677419   
75%                         9.000000         39.062500   
max                        21.000000        100.000000   

       Footnote for Q2 Measure Score  Q3 Measure Score  \
count                   30096.000000     222255.000000   
mean                        9.119717         28.010306   
std                         1.078166         36.341175   
min                         9.000000          0.000000   
25%                         9.000000          1.642325   
50%                         9.000000          9.090909   
75%                         9.000000         37.837838   
max                        21.000000        100.000000   

       Footnote for Q3 Measure Score  Q4 Measure Score  \
count                   29209.000000     222519.000000   
mean                        9.121504         27.763505   
std                         1.093571         36.364891   
min                         9.000000          0.000000   
25%                         9.000000          1.562500   
50%                         9.000000          8.695652   
75%                         9.000000         37.254902   
max                        21.000000        100.000000   

       Footnote for Q4 Measure Score  Four Quarter Average Score  \
count                   28945.000000               242689.000000   
mean                        9.111695                   27.987423   
std                         1.094674                   35.580175   
min                         9.000000                    0.000000   
25%                         9.000000                    2.020202   
50%                         9.000000                    9.864886   
75%                         9.000000                   36.609312   
max                        21.000000                  100.000000   

       Footnote for Four Quarter Average Score  
count                              8775.000000  
mean                                  9.358519  
std                                   1.963599  
min                                   9.000000  
25%                                   9.000000  
50%                                   9.000000  
75%                                   9.000000  
max                                  21.000000
2025-02-12 23:00:43,191 - INFO - === Data Quality Checks for nh_ownership ===
2025-02-12 23:00:43,234 - INFO - Missing Value Counts per Column:
2025-02-12 23:00:43,234 - INFO - CMS Certification Number (CCN)                   0
Provider Name                                    0
Provider Address                                 0
City/Town                                        0
State                                            0
ZIP Code                                         0
Role played by Owner or Manager in Facility      0
Owner Type                                     595
Owner Name                                     595
Ownership Percentage                           595
Association Date                               595
Location                                         0
Processing Date                                  0
dtype: int64
2025-02-12 23:00:43,348 - INFO - Number of Duplicate Rows: 0
2025-02-12 23:00:43,353 - INFO - Basic Stats for Numeric Columns:
2025-02-12 23:00:43,354 - INFO - ZIP Code
count  144651.000000
mean    49603.405237
std     26783.368229
min       660.000000
25%     28655.000000
50%     47532.000000
75%     71203.000000
max     99929.000000
2025-02-12 23:00:43,354 - INFO - === Data Quality Checks for nh_citations ===
2025-02-12 23:00:43,545 - INFO - Missing Value Counts per Column:
2025-02-12 23:00:43,546 - INFO - CMS Certification Number (CCN)                0
Provider Name                                 0
Provider Address                              0
City/Town                                     0
State                                         0
ZIP Code                                      0
Survey Date                                   0
Survey Type                                   0
Deficiency Prefix                             0
Deficiency Category                           0
Deficiency Tag Number                         0
Deficiency Description                        0
Scope Severity Code                           0
Deficiency Corrected                          0
Correction Date                            1392
Inspection Cycle                              0
Standard Deficiency                           0
Complaint Deficiency                          0
Infection Control Inspection Deficiency       0
Citation under IDR                            0
Citation under IIDR                           0
Location                                      0
Processing Date                               0
dtype: int64
2025-02-12 23:00:44,059 - INFO - Number of Duplicate Rows: 0
2025-02-12 23:00:44,089 - INFO - Basic Stats for Numeric Columns:
2025-02-12 23:00:44,090 - INFO - ZIP Code  Deficiency Tag Number  Inspection Cycle
count  406789.000000          406789.000000     406789.000000
mean    54492.822982             709.477156          1.958423
std     28369.178174             102.584999          0.812428
min       660.000000             151.000000          1.000000
25%     31040.000000             641.000000          1.000000
50%     55077.000000             689.000000          2.000000
75%     78052.000000             761.000000          3.000000
max     99929.000000             949.000000          3.000000
2025-02-12 23:00:44,090 - INFO - === Data Quality Checks Completed ===
2025-02-12 23:08:59,973 - INFO - === Starting Data Type Validation and Conversion ===
2025-02-12 23:08:59,973 - INFO - --- Evaluating pbj_nurse ---
2025-02-12 23:08:59,973 - INFO - Current Data Types:
2025-02-12 23:08:59,974 - INFO - PROVNUM              object
PROVNAME             object
CITY                 object
STATE                object
COUNTY_NAME          object
COUNTY_FIPS           int64
CY_Qtr               object
WorkDate              int64
MDScensus             int64
Hrs_RNDON           float64
Hrs_RNDON_emp       float64
Hrs_RNDON_ctr       float64
Hrs_RNadmin         float64
Hrs_RNadmin_emp     float64
Hrs_RNadmin_ctr     float64
Hrs_RN              float64
Hrs_RN_emp          float64
Hrs_RN_ctr          float64
Hrs_LPNadmin        float64
Hrs_LPNadmin_emp    float64
Hrs_LPNadmin_ctr    float64
Hrs_LPN             float64
Hrs_LPN_emp         float64
Hrs_LPN_ctr         float64
Hrs_CNA             float64
Hrs_CNA_emp         float64
Hrs_CNA_ctr         float64
Hrs_NAtrn           float64
Hrs_NAtrn_emp       float64
Hrs_NAtrn_ctr       float64
Hrs_MedAide         float64
Hrs_MedAide_emp     float64
Hrs_MedAide_ctr     float64
dtype: object
2025-02-12 23:09:00,319 - INFO - Converted 'WorkDate' to datetime for pbj_nurse
2025-02-12 23:09:00,319 - INFO - --- Evaluating pbj_non_nurse ---
2025-02-12 23:09:00,319 - INFO - Current Data Types:
2025-02-12 23:09:00,320 - INFO - PROVNUM               object
PROVNAME              object
CITY                  object
STATE                 object
COUNTY_NAME           object
                      ...   
Hrs_OthSocWrk_emp    float64
Hrs_OthSocWrk_ctr    float64
Hrs_MHSvc            float64
Hrs_MHSvc_emp        float64
Hrs_MHSvc_ctr        float64
Length: 82, dtype: object
2025-02-12 23:09:00,666 - INFO - Converted 'WorkDate' to datetime for pbj_non_nurse
2025-02-12 23:09:00,666 - INFO - --- Evaluating qrp_provider ---
2025-02-12 23:09:00,666 - INFO - Current Data Types:
2025-02-12 23:09:00,666 - INFO - CMS Certification Number (CCN)    object
Provider Name                     object
Address Line 1                    object
City/Town                         object
State                             object
ZIP Code                           int64
County/Parish                     object
Telephone Number                  object
CMS Region                         int64
Measure Code                      object
Score                             object
Footnote                          object
Start Date                        object
End Date                          object
Measure Date Range                object
LOCATION1                         object
dtype: object
2025-02-12 23:09:00,717 - INFO - Converted 'Start Date' to datetime for qrp_provider
2025-02-12 23:09:00,765 - INFO - Converted 'End Date' to datetime for qrp_provider
2025-02-12 23:09:00,765 - INFO - --- Evaluating nh_survey ---
2025-02-12 23:09:00,765 - INFO - Current Data Types:
2025-02-12 23:09:00,766 - INFO - CMS Certification Number (CCN)                                            object
Provider Name                                                             object
Provider Address                                                          object
City/Town                                                                 object
State                                                                     object
ZIP Code                                                                   int64
Inspection Cycle                                                           int64
Health Survey Date                                                        object
Fire Safety Survey Date                                                   object
Total Number of Health Deficiencies                                        int64
Total Number of Fire Safety Deficiencies                                 float64
Count of Freedom from Abuse and Neglect and Exploitation Deficiencies      int64
Count of Quality of Life and Care Deficiencies                             int64
Count of Resident Assessment and Care Planning Deficiencies                int64
Count of Nursing and Physician Services Deficiencies                       int64
Count of Resident Rights Deficiencies                                      int64
Count of Nutrition and Dietary Deficiencies                                int64
Count of Pharmacy Service Deficiencies                                     int64
Count of Environmental Deficiencies                                        int64
Count of Administration Deficiencies                                       int64
Count of Infection Control Deficiencies                                    int64
Count of Emergency Preparedness Deficiencies                             float64
Count of Automatic Sprinkler Systems Deficiencies                        float64
Count of Construction Deficiencies                                       float64
Count of Services Deficiencies                                           float64
Count of Corridor Walls and Doors Deficiencies                           float64
Count of Egress Deficiencies                                             float64
Count of Electrical Deficiencies                                         float64
Count of Emergency Plans and Fire Drills Deficiencies                    float64
Count of Fire Alarm Systems Deficiencies                                 float64
Count of Smoke Deficiencies                                              float64
Count of Interior Deficiencies                                           float64
Count of Gas and Vacuum and Electrical Systems Deficiencies              float64
Count of Hazardous Area Deficiencies                                     float64
Count of Illumination and Emergency Power Deficiencies                   float64
Count of Laboratories Deficiencies                                       float64
Count of Medical Gases and Anaesthetizing Areas Deficiencies             float64
Count of Smoking Regulations Deficiencies                                float64
Count of Miscellaneous Deficiencies                                      float64
Location                                                                  object
Processing Date                                                           object
dtype: object
2025-02-12 23:09:00,771 - INFO - Converted 'Health Survey Date' to datetime for nh_survey
2025-02-12 23:09:00,780 - INFO - Converted 'Fire Safety Survey Date' to datetime for nh_survey
2025-02-12 23:09:00,784 - INFO - Converted 'Processing Date' to datetime for nh_survey
2025-02-12 23:09:00,784 - INFO - --- Evaluating nh_quality_mds ---
2025-02-12 23:09:00,784 - INFO - Current Data Types:
2025-02-12 23:09:00,785 - INFO - CMS Certification Number (CCN)               object
Provider Name                                object
Provider Address                             object
City/Town                                    object
State                                        object
ZIP Code                                      int64
Measure Code                                  int64
Measure Description                          object
Resident type                                object
Q1 Measure Score                            float64
Footnote for Q1 Measure Score               float64
Q2 Measure Score                            float64
Footnote for Q2 Measure Score               float64
Q3 Measure Score                            float64
Footnote for Q3 Measure Score               float64
Q4 Measure Score                            float64
Footnote for Q4 Measure Score               float64
Four Quarter Average Score                  float64
Footnote for Four Quarter Average Score     float64
Used in Quality Measure Five Star Rating     object
Measure Period                               object
Location                                     object
Processing Date                              object
dtype: object
2025-02-12 23:09:00,804 - INFO - Converted 'Measure Period' to datetime for nh_quality_mds
2025-02-12 23:09:00,822 - INFO - Converted 'Processing Date' to datetime for nh_quality_mds
2025-02-12 23:09:00,822 - INFO - --- Evaluating nh_ownership ---
2025-02-12 23:09:00,822 - INFO - Current Data Types:
2025-02-12 23:09:00,823 - INFO - CMS Certification Number (CCN)                 object
Provider Name                                  object
Provider Address                               object
City/Town                                      object
State                                          object
ZIP Code                                        int64
Role played by Owner or Manager in Facility    object
Owner Type                                     object
Owner Name                                     object
Ownership Percentage                           object
Association Date                               object
Location                                       object
Processing Date                                object
dtype: object
2025-02-12 23:09:00,826 - ERROR - C:\Users\paulo\AppData\Local\Temp\ipykernel_27068\2166544758.py:38: UserWarning: Could not infer format, so each element will be parsed individually, falling back to `dateutil`. To ensure parsing is consistent and as-expected, please specify a format.
  df[col] = pd.to_datetime(df[col], errors='coerce')
2025-02-12 23:09:01,072 - INFO - Converted 'Association Date' to datetime for nh_ownership
2025-02-12 23:09:01,083 - INFO - Converted 'Processing Date' to datetime for nh_ownership
2025-02-12 23:09:01,083 - INFO - --- Evaluating nh_citations ---
2025-02-12 23:09:01,083 - INFO - Current Data Types:
2025-02-12 23:09:01,083 - INFO - CMS Certification Number (CCN)             object
Provider Name                              object
Provider Address                           object
City/Town                                  object
State                                      object
ZIP Code                                    int64
Survey Date                                object
Survey Type                                object
Deficiency Prefix                          object
Deficiency Category                        object
Deficiency Tag Number                       int64
Deficiency Description                     object
Scope Severity Code                        object
Deficiency Corrected                       object
Correction Date                            object
Inspection Cycle                            int64
Standard Deficiency                        object
Complaint Deficiency                       object
Infection Control Inspection Deficiency    object
Citation under IDR                         object
Citation under IIDR                        object
Location                                   object
Processing Date                            object
dtype: object
2025-02-12 23:09:01,113 - INFO - Converted 'Survey Date' to datetime for nh_citations
2025-02-12 23:09:01,136 - INFO - Converted 'Correction Date' to datetime for nh_citations
2025-02-12 23:09:01,164 - INFO - Converted 'Processing Date' to datetime for nh_citations
2025-02-12 23:09:01,165 - INFO - === Data Type Validation and Conversion Completed ===
2025-02-12 23:09:57,637 - INFO - [{"variableName": "datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "describe_df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "loaded_datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "missing_counts", "type": "series", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.series.Series"}]
2025-02-12 23:09:59,189 - INFO - [{"variableName": "datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "describe_df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "loaded_datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "missing_counts", "type": "series", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.series.Series"}]
2025-02-12 23:10:13,287 - INFO - [{"variableName": "datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "describe_df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "loaded_datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "missing_counts", "type": "series", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.series.Series"}]
2025-02-12 23:10:15,255 - INFO - [{"variableName": "datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "describe_df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "loaded_datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "missing_counts", "type": "series", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.series.Series"}]
2025-02-12 23:10:15,761 - INFO - [{"variableName": "datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "describe_df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "loaded_datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "missing_counts", "type": "series", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.series.Series"}]
2025-02-12 23:10:16,401 - INFO - [{"variableName": "datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "describe_df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "loaded_datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "missing_counts", "type": "series", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.series.Series"}]
2025-02-12 23:10:16,908 - INFO - [{"variableName": "datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "describe_df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "loaded_datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "missing_counts", "type": "series", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.series.Series"}]
2025-02-12 23:10:19,829 - INFO - [{"variableName": "datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "describe_df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "loaded_datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "missing_counts", "type": "series", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.series.Series"}]
2025-02-12 23:10:20,857 - INFO - [{"variableName": "datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "describe_df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "loaded_datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "missing_counts", "type": "series", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.series.Series"}]
2025-02-12 23:10:22,312 - INFO - [{"variableName": "datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "describe_df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "loaded_datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "missing_counts", "type": "series", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.series.Series"}]
2025-02-12 23:10:25,228 - INFO - [{"variableName": "datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "describe_df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "loaded_datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "missing_counts", "type": "series", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.series.Series"}]
2025-02-12 23:10:40,832 - INFO - [{"variableName": "datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "describe_df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "loaded_datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "missing_counts", "type": "series", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.series.Series"}]
2025-02-12 23:10:45,549 - INFO - [{"variableName": "datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "describe_df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "loaded_datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "missing_counts", "type": "series", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.series.Series"}]
2025-02-12 23:10:46,091 - INFO - [{"variableName": "datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "describe_df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "loaded_datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "missing_counts", "type": "series", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.series.Series"}]
2025-02-12 23:10:46,728 - INFO - [{"variableName": "datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "describe_df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "loaded_datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "missing_counts", "type": "series", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.series.Series"}]
2025-02-12 23:10:47,235 - INFO - [{"variableName": "datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "describe_df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "loaded_datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "missing_counts", "type": "series", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.series.Series"}]
2025-02-12 23:10:49,275 - INFO - [{"variableName": "datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "describe_df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "loaded_datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "missing_counts", "type": "series", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.series.Series"}]
2025-02-12 23:10:50,066 - INFO - [{"variableName": "datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "describe_df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "loaded_datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "missing_counts", "type": "series", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.series.Series"}]
2025-02-12 23:10:54,922 - INFO - [{"variableName": "datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "describe_df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "loaded_datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "missing_counts", "type": "series", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.series.Series"}]
2025-02-12 23:11:01,148 - INFO - [{"variableName": "datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "describe_df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "loaded_datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "missing_counts", "type": "series", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.series.Series"}]
2025-02-12 23:11:34,113 - INFO - {"type": "pandas", "supportedEngines": ["pandas"], "rawType": "pandas.core.frame.DataFrame"}
2025-02-12 23:13:01,960 - INFO - === Starting Data Type Validation and Conversion ===
2025-02-12 23:13:01,961 - INFO - --- Evaluating pbj_nurse ---
2025-02-12 23:13:01,961 - INFO - Current Data Types:
2025-02-12 23:13:01,961 - INFO - PROVNUM                     object
PROVNAME                    object
CITY                        object
STATE                       object
COUNTY_NAME                 object
COUNTY_FIPS                  int64
CY_Qtr                      object
WorkDate            datetime64[ns]
MDScensus                    int64
Hrs_RNDON                  float64
Hrs_RNDON_emp              float64
Hrs_RNDON_ctr              float64
Hrs_RNadmin                float64
Hrs_RNadmin_emp            float64
Hrs_RNadmin_ctr            float64
Hrs_RN                     float64
Hrs_RN_emp                 float64
Hrs_RN_ctr                 float64
Hrs_LPNadmin               float64
Hrs_LPNadmin_emp           float64
Hrs_LPNadmin_ctr           float64
Hrs_LPN                    float64
Hrs_LPN_emp                float64
Hrs_LPN_ctr                float64
Hrs_CNA                    float64
Hrs_CNA_emp                float64
Hrs_CNA_ctr                float64
Hrs_NAtrn                  float64
Hrs_NAtrn_emp              float64
Hrs_NAtrn_ctr              float64
Hrs_MedAide                float64
Hrs_MedAide_emp            float64
Hrs_MedAide_ctr            float64
dtype: object
2025-02-12 23:13:02,805 - INFO - Converted 'WorkDate' to datetime for pbj_nurse
2025-02-12 23:13:02,805 - INFO - --- Evaluating pbj_non_nurse ---
2025-02-12 23:13:02,805 - INFO - Current Data Types:
2025-02-12 23:13:02,806 - INFO - PROVNUM               object
PROVNAME              object
CITY                  object
STATE                 object
COUNTY_NAME           object
                      ...   
Hrs_OthSocWrk_emp    float64
Hrs_OthSocWrk_ctr    float64
Hrs_MHSvc            float64
Hrs_MHSvc_emp        float64
Hrs_MHSvc_ctr        float64
Length: 82, dtype: object
2025-02-12 23:13:03,659 - INFO - Converted 'WorkDate' to datetime for pbj_non_nurse
2025-02-12 23:13:03,659 - INFO - --- Evaluating qrp_provider ---
2025-02-12 23:13:03,659 - INFO - Current Data Types:
2025-02-12 23:13:03,659 - INFO - CMS Certification Number (CCN)            object
Provider Name                             object
Address Line 1                            object
City/Town                                 object
State                                     object
ZIP Code                                   int64
County/Parish                             object
Telephone Number                          object
CMS Region                                 int64
Measure Code                              object
Score                                     object
Footnote                                  object
Start Date                        datetime64[ns]
End Date                          datetime64[ns]
Measure Date Range                        object
LOCATION1                                 object
dtype: object
2025-02-12 23:13:03,677 - INFO - Converted 'Start Date' to datetime for qrp_provider
2025-02-12 23:13:03,695 - INFO - Converted 'End Date' to datetime for qrp_provider
2025-02-12 23:13:03,695 - INFO - --- Evaluating nh_survey ---
2025-02-12 23:13:03,695 - INFO - Current Data Types:
2025-02-12 23:13:03,696 - INFO - CMS Certification Number (CCN)                                                   object
Provider Name                                                                    object
Provider Address                                                                 object
City/Town                                                                        object
State                                                                            object
ZIP Code                                                                          int64
Inspection Cycle                                                                  int64
Health Survey Date                                                       datetime64[ns]
Fire Safety Survey Date                                                  datetime64[ns]
Total Number of Health Deficiencies                                               int64
Total Number of Fire Safety Deficiencies                                        float64
Count of Freedom from Abuse and Neglect and Exploitation Deficiencies             int64
Count of Quality of Life and Care Deficiencies                                    int64
Count of Resident Assessment and Care Planning Deficiencies                       int64
Count of Nursing and Physician Services Deficiencies                              int64
Count of Resident Rights Deficiencies                                             int64
Count of Nutrition and Dietary Deficiencies                                       int64
Count of Pharmacy Service Deficiencies                                            int64
Count of Environmental Deficiencies                                               int64
Count of Administration Deficiencies                                              int64
Count of Infection Control Deficiencies                                           int64
Count of Emergency Preparedness Deficiencies                                    float64
Count of Automatic Sprinkler Systems Deficiencies                               float64
Count of Construction Deficiencies                                              float64
Count of Services Deficiencies                                                  float64
Count of Corridor Walls and Doors Deficiencies                                  float64
Count of Egress Deficiencies                                                    float64
Count of Electrical Deficiencies                                                float64
Count of Emergency Plans and Fire Drills Deficiencies                           float64
Count of Fire Alarm Systems Deficiencies                                        float64
Count of Smoke Deficiencies                                                     float64
Count of Interior Deficiencies                                                  float64
Count of Gas and Vacuum and Electrical Systems Deficiencies                     float64
Count of Hazardous Area Deficiencies                                            float64
Count of Illumination and Emergency Power Deficiencies                          float64
Count of Laboratories Deficiencies                                              float64
Count of Medical Gases and Anaesthetizing Areas Deficiencies                    float64
Count of Smoking Regulations Deficiencies                                       float64
Count of Miscellaneous Deficiencies                                             float64
Location                                                                         object
Processing Date                                                          datetime64[ns]
dtype: object
2025-02-12 23:13:03,703 - INFO - Converted 'Health Survey Date' to datetime for nh_survey
2025-02-12 23:13:03,710 - INFO - Converted 'Fire Safety Survey Date' to datetime for nh_survey
2025-02-12 23:13:03,716 - INFO - Converted 'Processing Date' to datetime for nh_survey
2025-02-12 23:13:03,716 - INFO - --- Evaluating nh_quality_mds ---
2025-02-12 23:13:03,716 - INFO - Current Data Types:
2025-02-12 23:13:03,717 - INFO - CMS Certification Number (CCN)                      object
Provider Name                                       object
Provider Address                                    object
City/Town                                           object
State                                               object
ZIP Code                                             int64
Measure Code                                         int64
Measure Description                                 object
Resident type                                       object
Q1 Measure Score                                   float64
Footnote for Q1 Measure Score                      float64
Q2 Measure Score                                   float64
Footnote for Q2 Measure Score                      float64
Q3 Measure Score                                   float64
Footnote for Q3 Measure Score                      float64
Q4 Measure Score                                   float64
Footnote for Q4 Measure Score                      float64
Four Quarter Average Score                         float64
Footnote for Four Quarter Average Score            float64
Used in Quality Measure Five Star Rating            object
Measure Period                              datetime64[ns]
Location                                            object
Processing Date                             datetime64[ns]
dtype: object
2025-02-12 23:13:03,722 - INFO - Converted 'Measure Period' to datetime for nh_quality_mds
2025-02-12 23:13:03,736 - INFO - Converted 'Processing Date' to datetime for nh_quality_mds
2025-02-12 23:13:03,736 - INFO - --- Evaluating nh_ownership ---
2025-02-12 23:13:03,736 - INFO - Current Data Types:
2025-02-12 23:13:03,737 - INFO - CMS Certification Number (CCN)                         object
Provider Name                                          object
Provider Address                                       object
City/Town                                              object
State                                                  object
ZIP Code                                                int64
Role played by Owner or Manager in Facility            object
Owner Type                                             object
Owner Name                                             object
Ownership Percentage                                   object
Association Date                               datetime64[ns]
Location                                               object
Processing Date                                datetime64[ns]
dtype: object
2025-02-12 23:13:03,741 - INFO - Converted 'Association Date' to datetime for nh_ownership with format='%Y-%m-%d'
2025-02-12 23:13:03,750 - INFO - Converted 'Processing Date' to datetime for nh_ownership with format='%Y-%m-%d'
2025-02-12 23:13:03,750 - INFO - --- Evaluating nh_citations ---
2025-02-12 23:13:03,750 - INFO - Current Data Types:
2025-02-12 23:13:03,750 - INFO - CMS Certification Number (CCN)                     object
Provider Name                                      object
Provider Address                                   object
City/Town                                          object
State                                              object
ZIP Code                                            int64
Survey Date                                datetime64[ns]
Survey Type                                        object
Deficiency Prefix                                  object
Deficiency Category                                object
Deficiency Tag Number                               int64
Deficiency Description                             object
Scope Severity Code                                object
Deficiency Corrected                               object
Correction Date                            datetime64[ns]
Inspection Cycle                                    int64
Standard Deficiency                                object
Complaint Deficiency                               object
Infection Control Inspection Deficiency            object
Citation under IDR                                 object
Citation under IIDR                                object
Location                                           object
Processing Date                            datetime64[ns]
dtype: object
2025-02-12 23:13:03,765 - INFO - Converted 'Survey Date' to datetime for nh_citations
2025-02-12 23:13:03,781 - INFO - Converted 'Correction Date' to datetime for nh_citations
2025-02-12 23:13:03,825 - INFO - Converted 'Processing Date' to datetime for nh_citations
2025-02-12 23:13:03,826 - INFO - === Data Type Validation and Conversion Completed ===
2025-02-12 23:14:14,606 - INFO - === Starting Standardization & Basic Cleaning ===
2025-02-12 23:14:14,606 - INFO - --- Standardizing columns for pbj_nurse ---
2025-02-12 23:14:14,607 - INFO - New columns:
2025-02-12 23:14:14,607 - INFO - ['provnum', 'provname', 'city', 'state', 'county_name', 'county_fips', 'cy_qtr', 'workdate', 'mdscensus', 'hrs_rndon', 'hrs_rndon_emp', 'hrs_rndon_ctr', 'hrs_rnadmin', 'hrs_rnadmin_emp', 'hrs_rnadmin_ctr', 'hrs_rn', 'hrs_rn_emp', 'hrs_rn_ctr', 'hrs_lpnadmin', 'hrs_lpnadmin_emp', 'hrs_lpnadmin_ctr', 'hrs_lpn', 'hrs_lpn_emp', 'hrs_lpn_ctr', 'hrs_cna', 'hrs_cna_emp', 'hrs_cna_ctr', 'hrs_natrn', 'hrs_natrn_emp', 'hrs_natrn_ctr', 'hrs_medaide', 'hrs_medaide_emp', 'hrs_medaide_ctr']
2025-02-12 23:14:14,607 - INFO - --- Standardizing columns for pbj_non_nurse ---
2025-02-12 23:14:14,607 - INFO - New columns:
2025-02-12 23:14:14,607 - INFO - ['provnum', 'provname', 'city', 'state', 'county_name', 'county_fips', 'cy_qtr', 'workdate', 'mdscensus', 'hrs_admin', 'hrs_admin_emp', 'hrs_admin_ctr', 'hrs_admin_fn', 'hrs_meddir', 'hrs_meddir_emp', 'hrs_meddir_ctr', 'hrs_othmd', 'hrs_othmd_emp', 'hrs_othmd_ctr', 'hrs_pa', 'hrs_pa_emp', 'hrs_pa_ctr', 'hrs_np', 'hrs_np_emp', 'hrs_np_ctr', 'hrs_clinnrsspec', 'hrs_clinnrsspec_emp', 'hrs_clinnrsspec_ctr', 'hrs_pharmacist', 'hrs_pharmacist_emp', 'hrs_pharmacist_ctr', 'hrs_dietician', 'hrs_dietician_emp', 'hrs_dietician_ctr', 'hrs_feedasst', 'hrs_feedasst_emp', 'hrs_feedasst_ctr', 'hrs_ot', 'hrs_ot_emp', 'hrs_ot_ctr', 'hrs_otasst', 'hrs_otasst_emp', 'hrs_otasst_ctr', 'hrs_otaide', 'hrs_otaide_emp', 'hrs_otaide_ctr', 'hrs_pt', 'hrs_pt_emp', 'hrs_pt_ctr', 'hrs_ptasst', 'hrs_ptasst_emp', 'hrs_ptasst_ctr', 'hrs_ptaide', 'hrs_ptaide_emp', 'hrs_ptaide_ctr', 'hrs_respther', 'hrs_respther_emp', 'hrs_respther_ctr', 'hrs_resptech', 'hrs_resptech_emp', 'hrs_resptech_ctr', 'hrs_spclangpath', 'hrs_spclangpath_emp', 'hrs_spclangpath_ctr', 'hrs_therrecspec', 'hrs_therrecspec_emp', 'hrs_therrecspec_ctr', 'hrs_qualactvprof', 'hrs_qualactvprof_emp', 'hrs_qualactvprof_ctr', 'hrs_othactv', 'hrs_othactv_emp', 'hrs_othactv_ctr', 'hrs_qualsocwrk', 'hrs_qualsocwrk_emp', 'hrs_qualsocwrk_ctr', 'hrs_othsocwrk', 'hrs_othsocwrk_emp', 'hrs_othsocwrk_ctr', 'hrs_mhsvc', 'hrs_mhsvc_emp', 'hrs_mhsvc_ctr']
2025-02-12 23:14:14,607 - INFO - --- Standardizing columns for qrp_provider ---
2025-02-12 23:14:14,607 - INFO - New columns:
2025-02-12 23:14:14,607 - INFO - ['cms_certification_number_(ccn)', 'provider_name', 'address_line_1', 'city/town', 'state', 'zip_code', 'county/parish', 'telephone_number', 'cms_region', 'measure_code', 'score', 'footnote', 'start_date', 'end_date', 'measure_date_range', 'location1']
2025-02-12 23:14:14,607 - INFO - --- Standardizing columns for nh_survey ---
2025-02-12 23:14:14,608 - INFO - New columns:
2025-02-12 23:14:14,608 - INFO - ['cms_certification_number_(ccn)', 'provider_name', 'provider_address', 'city/town', 'state', 'zip_code', 'inspection_cycle', 'health_survey_date', 'fire_safety_survey_date', 'total_number_of_health_deficiencies', 'total_number_of_fire_safety_deficiencies', 'count_of_freedom_from_abuse_and_neglect_and_exploitation_deficiencies', 'count_of_quality_of_life_and_care_deficiencies', 'count_of_resident_assessment_and_care_planning_deficiencies', 'count_of_nursing_and_physician_services_deficiencies', 'count_of_resident_rights_deficiencies', 'count_of_nutrition_and_dietary_deficiencies', 'count_of_pharmacy_service_deficiencies', 'count_of_environmental_deficiencies', 'count_of_administration_deficiencies', 'count_of_infection_control_deficiencies', 'count_of_emergency_preparedness_deficiencies', 'count_of_automatic_sprinkler_systems_deficiencies', 'count_of_construction_deficiencies', 'count_of_services_deficiencies', 'count_of_corridor_walls_and_doors_deficiencies', 'count_of_egress_deficiencies', 'count_of_electrical_deficiencies', 'count_of_emergency_plans_and_fire_drills_deficiencies', 'count_of_fire_alarm_systems_deficiencies', 'count_of_smoke_deficiencies', 'count_of_interior_deficiencies', 'count_of_gas_and_vacuum_and_electrical_systems_deficiencies', 'count_of_hazardous_area_deficiencies', 'count_of_illumination_and_emergency_power_deficiencies', 'count_of_laboratories_deficiencies', 'count_of_medical_gases_and_anaesthetizing_areas_deficiencies', 'count_of_smoking_regulations_deficiencies', 'count_of_miscellaneous_deficiencies', 'location', 'processing_date']
2025-02-12 23:14:14,608 - INFO - --- Standardizing columns for nh_quality_mds ---
2025-02-12 23:14:14,608 - INFO - New columns:
2025-02-12 23:14:14,608 - INFO - ['cms_certification_number_(ccn)', 'provider_name', 'provider_address', 'city/town', 'state', 'zip_code', 'measure_code', 'measure_description', 'resident_type', 'q1_measure_score', 'footnote_for_q1_measure_score', 'q2_measure_score', 'footnote_for_q2_measure_score', 'q3_measure_score', 'footnote_for_q3_measure_score', 'q4_measure_score', 'footnote_for_q4_measure_score', 'four_quarter_average_score', 'footnote_for_four_quarter_average_score', 'used_in_quality_measure_five_star_rating', 'measure_period', 'location', 'processing_date']
2025-02-12 23:14:14,608 - INFO - --- Standardizing columns for nh_ownership ---
2025-02-12 23:14:14,608 - INFO - New columns:
2025-02-12 23:14:14,608 - INFO - ['cms_certification_number_(ccn)', 'provider_name', 'provider_address', 'city/town', 'state', 'zip_code', 'role_played_by_owner_or_manager_in_facility', 'owner_type', 'owner_name', 'ownership_percentage', 'association_date', 'location', 'processing_date']
2025-02-12 23:14:14,608 - INFO - --- Standardizing columns for nh_citations ---
2025-02-12 23:14:14,608 - INFO - New columns:
2025-02-12 23:14:14,608 - INFO - ['cms_certification_number_(ccn)', 'provider_name', 'provider_address', 'city/town', 'state', 'zip_code', 'survey_date', 'survey_type', 'deficiency_prefix', 'deficiency_category', 'deficiency_tag_number', 'deficiency_description', 'scope_severity_code', 'deficiency_corrected', 'correction_date', 'inspection_cycle', 'standard_deficiency', 'complaint_deficiency', 'infection_control_inspection_deficiency', 'citation_under_idr', 'citation_under_iidr', 'location', 'processing_date']
2025-02-12 23:14:14,608 - INFO - === Standardization & Basic Cleaning Completed ===
2025-02-12 23:19:22,811 - INFO - === Saving Final Prepared Datasets ===
2025-02-12 23:19:24,103 - INFO - Saved pbj_nurse to ./data/prepared/pbj_nurse_prepared.parquet
2025-02-12 23:19:26,293 - INFO - Saved pbj_non_nurse to ./data/prepared/pbj_non_nurse_prepared.parquet
2025-02-12 23:19:27,059 - INFO - Saved qrp_provider to ./data/prepared/qrp_provider_prepared.parquet
2025-02-12 23:19:27,132 - INFO - Saved nh_survey to ./data/prepared/nh_survey_prepared.parquet
2025-02-12 23:19:27,427 - INFO - Saved nh_quality_mds to ./data/prepared/nh_quality_mds_prepared.parquet
2025-02-12 23:19:27,588 - INFO - Saved nh_ownership to ./data/prepared/nh_ownership_prepared.parquet
2025-02-12 23:19:28,239 - INFO - Saved nh_citations to ./data/prepared/nh_citations_prepared.parquet
2025-02-12 23:19:28,239 - INFO - === Final Save Completed. Datasets are now ready for analysis. ===
2025-02-13 00:10:27,902 - INFO - [{"variableName": "datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "describe_df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "loaded_datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "missing_counts", "type": "series", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.series.Series"}, {"variableName": "new_columns", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}]
2025-02-13 00:10:28,444 - INFO - [{"variableName": "datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "describe_df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "loaded_datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "missing_counts", "type": "series", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.series.Series"}, {"variableName": "new_columns", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}]
2025-02-13 00:10:29,528 - INFO - [{"variableName": "datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "describe_df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "loaded_datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "missing_counts", "type": "series", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.series.Series"}, {"variableName": "new_columns", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}]
2025-02-13 00:11:46,076 - INFO - === Prepare Phase Notebook: Logging Setup Complete ===
2025-02-13 00:11:46,076 - INFO - Using PARQUET_PATH: ./data/interim/
2025-02-13 00:11:46,077 - INFO - Logs will be written to: prepare_phase_parquet_output.log
2025-02-13 00:11:46,083 - INFO - === Starting Prepare Phase (Parquet Version) ===
2025-02-13 00:11:46,668 - INFO - Loaded 'pbj_nurse' from ./data/interim/preprocessed_pbj_nurse.parquet. Shape: (1325324, 33)
2025-02-13 00:11:47,045 - INFO - Loaded 'pbj_non_nurse' from ./data/interim/preprocessed_pbj_non_nurse.parquet. Shape: (1325324, 82)
2025-02-13 00:11:47,389 - INFO - Loaded 'qrp_provider' from ./data/interim/preprocessed_qrp_provider.parquet. Shape: (710016, 16)
2025-02-13 00:11:47,421 - INFO - Loaded 'nh_survey' from ./data/interim/preprocessed_nh_survey.parquet. Shape: (44189, 41)
2025-02-13 00:11:47,537 - INFO - Loaded 'nh_quality_mds' from ./data/interim/preprocessed_nh_quality_mds.parquet. Shape: (251464, 23)
2025-02-13 00:11:47,624 - INFO - Loaded 'nh_ownership' from ./data/interim/preprocessed_nh_ownership.parquet. Shape: (144651, 13)
2025-02-13 00:11:47,933 - INFO - Loaded 'nh_citations' from ./data/interim/preprocessed_nh_citations.parquet. Shape: (406789, 23)
2025-02-13 00:11:47,933 - INFO - === Summary of Loaded Datasets ===
2025-02-13 00:11:47,933 - INFO - pbj_nurse: shape=(1325324, 33), columns=['PROVNUM', 'PROVNAME', 'CITY', 'STATE', 'COUNTY_NAME', 'COUNTY_FIPS', 'CY_Qtr', 'WorkDate', 'MDScensus', 'Hrs_RNDON', 'Hrs_RNDON_emp', 'Hrs_RNDON_ctr', 'Hrs_RNadmin', 'Hrs_RNadmin_emp', 'Hrs_RNadmin_ctr', 'Hrs_RN', 'Hrs_RN_emp', 'Hrs_RN_ctr', 'Hrs_LPNadmin', 'Hrs_LPNadmin_emp', 'Hrs_LPNadmin_ctr', 'Hrs_LPN', 'Hrs_LPN_emp', 'Hrs_LPN_ctr', 'Hrs_CNA', 'Hrs_CNA_emp', 'Hrs_CNA_ctr', 'Hrs_NAtrn', 'Hrs_NAtrn_emp', 'Hrs_NAtrn_ctr', 'Hrs_MedAide', 'Hrs_MedAide_emp', 'Hrs_MedAide_ctr']
2025-02-13 00:11:47,933 - INFO - pbj_non_nurse: shape=(1325324, 82), columns=['PROVNUM', 'PROVNAME', 'CITY', 'STATE', 'COUNTY_NAME', 'COUNTY_FIPS', 'CY_Qtr', 'WorkDate', 'MDScensus', 'Hrs_Admin', 'Hrs_Admin_emp', 'Hrs_Admin_ctr', 'Hrs_Admin_fn', 'Hrs_MedDir', 'Hrs_MedDir_emp', 'Hrs_MedDir_ctr', 'Hrs_OthMD', 'Hrs_OthMD_emp', 'Hrs_OthMD_ctr', 'Hrs_PA', 'Hrs_PA_emp', 'Hrs_PA_ctr', 'Hrs_NP', 'Hrs_NP_emp', 'Hrs_NP_ctr', 'Hrs_ClinNrsSpec', 'Hrs_ClinNrsSpec_emp', 'Hrs_ClinNrsSpec_ctr', 'Hrs_Pharmacist', 'Hrs_Pharmacist_emp', 'Hrs_Pharmacist_ctr', 'Hrs_Dietician', 'Hrs_Dietician_emp', 'Hrs_Dietician_ctr', 'Hrs_FeedAsst', 'Hrs_FeedAsst_emp', 'Hrs_FeedAsst_ctr', 'Hrs_OT', 'Hrs_OT_emp', 'Hrs_OT_ctr', 'Hrs_OTasst', 'Hrs_OTasst_emp', 'Hrs_OTasst_ctr', 'Hrs_OTaide', 'Hrs_OTaide_emp', 'Hrs_OTaide_ctr', 'Hrs_PT', 'Hrs_PT_emp', 'Hrs_PT_ctr', 'Hrs_PTasst', 'Hrs_PTasst_emp', 'Hrs_PTasst_ctr', 'Hrs_PTaide', 'Hrs_PTaide_emp', 'Hrs_PTaide_ctr', 'Hrs_RespTher', 'Hrs_RespTher_emp', 'Hrs_RespTher_ctr', 'Hrs_RespTech', 'Hrs_RespTech_emp', 'Hrs_RespTech_ctr', 'Hrs_SpcLangPath', 'Hrs_SpcLangPath_emp', 'Hrs_SpcLangPath_ctr', 'Hrs_TherRecSpec', 'Hrs_TherRecSpec_emp', 'Hrs_TherRecSpec_ctr', 'Hrs_QualActvProf', 'Hrs_QualActvProf_emp', 'Hrs_QualActvProf_ctr', 'Hrs_OthActv', 'Hrs_OthActv_emp', 'Hrs_OthActv_ctr', 'Hrs_QualSocWrk', 'Hrs_QualSocWrk_emp', 'Hrs_QualSocWrk_ctr', 'Hrs_OthSocWrk', 'Hrs_OthSocWrk_emp', 'Hrs_OthSocWrk_ctr', 'Hrs_MHSvc', 'Hrs_MHSvc_emp', 'Hrs_MHSvc_ctr']
2025-02-13 00:11:47,933 - INFO - qrp_provider: shape=(710016, 16), columns=['CMS Certification Number (CCN)', 'Provider Name', 'Address Line 1', 'City/Town', 'State', 'ZIP Code', 'County/Parish', 'Telephone Number', 'CMS Region', 'Measure Code', 'Score', 'Footnote', 'Start Date', 'End Date', 'Measure Date Range', 'LOCATION1']
2025-02-13 00:11:47,933 - INFO - nh_survey: shape=(44189, 41), columns=['CMS Certification Number (CCN)', 'Provider Name', 'Provider Address', 'City/Town', 'State', 'ZIP Code', 'Inspection Cycle', 'Health Survey Date', 'Fire Safety Survey Date', 'Total Number of Health Deficiencies', 'Total Number of Fire Safety Deficiencies', 'Count of Freedom from Abuse and Neglect and Exploitation Deficiencies', 'Count of Quality of Life and Care Deficiencies', 'Count of Resident Assessment and Care Planning Deficiencies', 'Count of Nursing and Physician Services Deficiencies', 'Count of Resident Rights Deficiencies', 'Count of Nutrition and Dietary Deficiencies', 'Count of Pharmacy Service Deficiencies', 'Count of Environmental Deficiencies', 'Count of Administration Deficiencies', 'Count of Infection Control Deficiencies', 'Count of Emergency Preparedness Deficiencies', 'Count of Automatic Sprinkler Systems Deficiencies', 'Count of Construction Deficiencies', 'Count of Services Deficiencies', 'Count of Corridor Walls and Doors Deficiencies', 'Count of Egress Deficiencies', 'Count of Electrical Deficiencies', 'Count of Emergency Plans and Fire Drills Deficiencies', 'Count of Fire Alarm Systems Deficiencies', 'Count of Smoke Deficiencies', 'Count of Interior Deficiencies', 'Count of Gas and Vacuum and Electrical Systems Deficiencies', 'Count of Hazardous Area Deficiencies', 'Count of Illumination and Emergency Power Deficiencies', 'Count of Laboratories Deficiencies', 'Count of Medical Gases and Anaesthetizing Areas Deficiencies', 'Count of Smoking Regulations Deficiencies', 'Count of Miscellaneous Deficiencies', 'Location', 'Processing Date']
2025-02-13 00:11:47,934 - INFO - nh_quality_mds: shape=(251464, 23), columns=['CMS Certification Number (CCN)', 'Provider Name', 'Provider Address', 'City/Town', 'State', 'ZIP Code', 'Measure Code', 'Measure Description', 'Resident type', 'Q1 Measure Score', 'Footnote for Q1 Measure Score', 'Q2 Measure Score', 'Footnote for Q2 Measure Score', 'Q3 Measure Score', 'Footnote for Q3 Measure Score', 'Q4 Measure Score', 'Footnote for Q4 Measure Score', 'Four Quarter Average Score', 'Footnote for Four Quarter Average Score', 'Used in Quality Measure Five Star Rating', 'Measure Period', 'Location', 'Processing Date']
2025-02-13 00:11:47,934 - INFO - nh_ownership: shape=(144651, 13), columns=['CMS Certification Number (CCN)', 'Provider Name', 'Provider Address', 'City/Town', 'State', 'ZIP Code', 'Role played by Owner or Manager in Facility', 'Owner Type', 'Owner Name', 'Ownership Percentage', 'Association Date', 'Location', 'Processing Date']
2025-02-13 00:11:47,934 - INFO - nh_citations: shape=(406789, 23), columns=['CMS Certification Number (CCN)', 'Provider Name', 'Provider Address', 'City/Town', 'State', 'ZIP Code', 'Survey Date', 'Survey Type', 'Deficiency Prefix', 'Deficiency Category', 'Deficiency Tag Number', 'Deficiency Description', 'Scope Severity Code', 'Deficiency Corrected', 'Correction Date', 'Inspection Cycle', 'Standard Deficiency', 'Complaint Deficiency', 'Infection Control Inspection Deficiency', 'Citation under IDR', 'Citation under IIDR', 'Location', 'Processing Date']
2025-02-13 00:11:47,934 - INFO - === Prepare Phase (Parquet) - Load Step Completed ===
2025-02-13 00:11:47,939 - INFO - === Data Quality Checks for pbj_nurse ===
2025-02-13 00:11:48,189 - INFO - Missing Value Counts per Column:
2025-02-13 00:11:48,190 - INFO - PROVNUM             0
PROVNAME            0
CITY                0
STATE               0
COUNTY_NAME         0
COUNTY_FIPS         0
CY_Qtr              0
WorkDate            0
MDScensus           0
Hrs_RNDON           0
Hrs_RNDON_emp       0
Hrs_RNDON_ctr       0
Hrs_RNadmin         0
Hrs_RNadmin_emp     0
Hrs_RNadmin_ctr     0
Hrs_RN              0
Hrs_RN_emp          0
Hrs_RN_ctr          0
Hrs_LPNadmin        0
Hrs_LPNadmin_emp    0
Hrs_LPNadmin_ctr    0
Hrs_LPN             0
Hrs_LPN_emp         0
Hrs_LPN_ctr         0
Hrs_CNA             0
Hrs_CNA_emp         0
Hrs_CNA_ctr         0
Hrs_NAtrn           0
Hrs_NAtrn_emp       0
Hrs_NAtrn_ctr       0
Hrs_MedAide         0
Hrs_MedAide_emp     0
Hrs_MedAide_ctr     0
dtype: int64
2025-02-13 00:11:49,590 - INFO - Number of Duplicate Rows: 0
2025-02-13 00:11:50,713 - INFO - Basic Stats for Numeric Columns:
2025-02-13 00:11:50,719 - INFO - COUNTY_FIPS      WorkDate     MDScensus     Hrs_RNDON  Hrs_RNDON_emp  \
count  1.325324e+06  1.325324e+06  1.325324e+06  1.325324e+06   1.325324e+06   
mean   9.113430e+01  2.024052e+07  8.341670e+01  5.195887e+00   5.099312e+00   
std    9.912806e+01  8.167078e+01  4.904109e+01  4.389664e+00   4.382255e+00   
min    1.000000e+00  2.024040e+07  0.000000e+00  0.000000e+00   0.000000e+00   
25%    3.100000e+01  2.024042e+07  5.100000e+01  0.000000e+00   0.000000e+00   
50%    6.900000e+01  2.024052e+07  7.600000e+01  8.000000e+00   8.000000e+00   
75%    1.170000e+02  2.024061e+07  1.040000e+02  8.000000e+00   8.000000e+00   
max    8.400000e+02  2.024063e+07  7.420000e+02  1.039600e+02   1.039600e+02   

       Hrs_RNDON_ctr   Hrs_RNadmin  Hrs_RNadmin_emp  Hrs_RNadmin_ctr  \
count   1.325324e+06  1.325324e+06     1.325324e+06     1.325324e+06   
mean    9.657448e-02  1.026275e+01     1.001164e+01     2.511122e-01   
std     9.182349e-01  1.476875e+01     1.455953e+01     1.845270e+00   
min     0.000000e+00  0.000000e+00     0.000000e+00     0.000000e+00   
25%     0.000000e+00  0.000000e+00     0.000000e+00     0.000000e+00   
50%     0.000000e+00  7.500000e+00     7.500000e+00     0.000000e+00   
75%     0.000000e+00  1.600000e+01     1.600000e+01     0.000000e+00   
max     2.575000e+01  2.755000e+02     2.755000e+02     8.725000e+01   

             Hrs_RN  ...   Hrs_LPN_ctr       Hrs_CNA   Hrs_CNA_emp  \
count  1.325324e+06  ...  1.325324e+06  1.325324e+06  1.325324e+06   
mean   3.480192e+01  ...  6.133439e+00  1.737908e+02  1.616093e+02   
std    3.532269e+01  ...  1.963754e+01  1.151591e+02  1.081243e+02   
min    0.000000e+00  ...  0.000000e+00  0.000000e+00  0.000000e+00   
25%    1.325000e+01  ...  0.000000e+00  9.857000e+01  9.025000e+01   
50%    2.575000e+01  ...  0.000000e+00  1.506200e+02  1.400000e+02   
75%    4.525000e+01  ...  4.000000e+00  2.200000e+02  2.074800e+02   
max    9.159800e+02  ...  1.380150e+04  1.758100e+03  1.503630e+03   

        Hrs_CNA_ctr     Hrs_NAtrn  Hrs_NAtrn_emp  Hrs_NAtrn_ctr   Hrs_MedAide  \
count  1.325324e+06  1.325324e+06   1.325324e+06   1.325324e+06  1.325324e+06   
mean   1.218150e+01  4.314155e+00   4.262067e+00   5.208815e-02  8.578327e+00   
std    3.184142e+01  1.336067e+01   1.302080e+01   2.011555e+00  1.785970e+01   
min    0.000000e+00  0.000000e+00   0.000000e+00   0.000000e+00  0.000000e+00   
25%    0.000000e+00  0.000000e+00   0.000000e+00   0.000000e+00  0.000000e+00   
50%    0.000000e+00  0.000000e+00   0.000000e+00   0.000000e+00  0.000000e+00   
75%    8.000000e+00  0.000000e+00   0.000000e+00   0.000000e+00  1.131000e+01   
max    6.614200e+02  4.437500e+02   4.387500e+02   2.470000e+02  4.298000e+02   

       Hrs_MedAide_emp  Hrs_MedAide_ctr  
count     1.325324e+06     1.325324e+06  
mean      8.363303e+00     2.150232e-01  
std       1.749784e+01     2.104964e+00  
min       0.000000e+00     0.000000e+00  
25%       0.000000e+00     0.000000e+00  
50%       0.000000e+00     0.000000e+00  
75%       1.087000e+01     0.000000e+00  
max       4.298000e+02     8.775000e+01  

[8 rows x 27 columns]
2025-02-13 00:11:50,720 - INFO - === Data Quality Checks for pbj_non_nurse ===
2025-02-13 00:11:51,036 - INFO - Missing Value Counts per Column:
2025-02-13 00:11:51,037 - INFO - PROVNUM              0
PROVNAME             0
CITY                 0
STATE                0
COUNTY_NAME          0
                    ..
Hrs_OthSocWrk_emp    0
Hrs_OthSocWrk_ctr    0
Hrs_MHSvc            0
Hrs_MHSvc_emp        0
Hrs_MHSvc_ctr        0
Length: 82, dtype: int64
2025-02-13 00:11:53,489 - INFO - Number of Duplicate Rows: 0
2025-02-13 00:11:56,675 - INFO - Basic Stats for Numeric Columns:
2025-02-13 00:11:56,681 - INFO - COUNTY_FIPS      WorkDate     MDScensus     Hrs_Admin  Hrs_Admin_emp  \
count  1.325324e+06  1.325324e+06  1.325324e+06  1.319227e+06   1.319227e+06   
mean   9.113430e+01  2.024052e+07  8.341670e+01  5.415150e+00   5.282056e+00   
std    9.912806e+01  8.167078e+01  4.904109e+01  4.642567e+00   4.643081e+00   
min    1.000000e+00  2.024040e+07  0.000000e+00  0.000000e+00   0.000000e+00   
25%    3.100000e+01  2.024042e+07  5.100000e+01  0.000000e+00   0.000000e+00   
50%    6.900000e+01  2.024052e+07  7.600000e+01  8.000000e+00   8.000000e+00   
75%    1.170000e+02  2.024061e+07  1.040000e+02  8.000000e+00   8.000000e+00   
max    8.400000e+02  2.024063e+07  7.420000e+02  6.800000e+01   4.525000e+01   

       Hrs_Admin_ctr  Hrs_Admin_fn    Hrs_MedDir  Hrs_MedDir_emp  \
count   1.319227e+06        6097.0  1.325324e+06    1.325324e+06   
mean    1.330937e-01           1.0  3.762991e-01    7.830458e-02   
std     1.072293e+00           0.0  1.460066e+00    7.513089e-01   
min     0.000000e+00           1.0  0.000000e+00    0.000000e+00   
25%     0.000000e+00           1.0  0.000000e+00    0.000000e+00   
50%     0.000000e+00           1.0  0.000000e+00    0.000000e+00   
75%     0.000000e+00           1.0  0.000000e+00    0.000000e+00   
max     6.800000e+01           1.0  6.125000e+01    6.125000e+01   

       Hrs_MedDir_ctr  ...  Hrs_OthActv_ctr  Hrs_QualSocWrk  \
count    1.325324e+06  ...     1.325324e+06    1.325324e+06   
mean     2.979946e-01  ...     1.181517e-01    4.373406e+00   
std      1.259352e+00  ...     2.033839e+00    6.575853e+00   
min      0.000000e+00  ...     0.000000e+00    0.000000e+00   
25%      0.000000e+00  ...     0.000000e+00    0.000000e+00   
50%      0.000000e+00  ...     0.000000e+00    0.000000e+00   
75%      0.000000e+00  ...     0.000000e+00    8.000000e+00   
max      3.900000e+01  ...     1.092500e+02    9.075000e+01   

       Hrs_QualSocWrk_emp  Hrs_QualSocWrk_ctr  Hrs_OthSocWrk  \
count        1.325324e+06        1.325324e+06   1.325324e+06   
mean         4.342660e+00        3.074557e-02   3.107487e+00   
std          6.537645e+00        5.176069e-01   6.729960e+00   
min          0.000000e+00        0.000000e+00   0.000000e+00   
25%          0.000000e+00        0.000000e+00   0.000000e+00   
50%          0.000000e+00        0.000000e+00   0.000000e+00   
75%          8.000000e+00        0.000000e+00   5.960000e+00   
max          9.075000e+01        3.180000e+01   2.007800e+02   

       Hrs_OthSocWrk_emp  Hrs_OthSocWrk_ctr     Hrs_MHSvc  Hrs_MHSvc_emp  \
count       1.325324e+06       1.325324e+06  1.325324e+06   1.325324e+06   
mean        3.091622e+00       1.586563e-02  3.314399e-01   3.030647e-01   
std         6.698340e+00       6.564691e-01  4.929164e+00   4.847544e+00   
min         0.000000e+00       0.000000e+00  0.000000e+00   0.000000e+00   
25%         0.000000e+00       0.000000e+00  0.000000e+00   0.000000e+00   
50%         0.000000e+00       0.000000e+00  0.000000e+00   0.000000e+00   
75%         5.770000e+00       0.000000e+00  0.000000e+00   0.000000e+00   
max         2.007800e+02       1.010000e+02  3.942700e+02   3.872700e+02   

       Hrs_MHSvc_ctr  
count   1.325324e+06  
mean    2.837520e-02  
std     4.830650e-01  
min     0.000000e+00  
25%     0.000000e+00  
50%     0.000000e+00  
75%     0.000000e+00  
max     4.100000e+01  

[8 rows x 76 columns]
2025-02-13 00:11:56,681 - INFO - === Data Quality Checks for qrp_provider ===
2025-02-13 00:11:56,927 - INFO - Missing Value Counts per Column:
2025-02-13 00:11:56,928 - INFO - CMS Certification Number (CCN)    0
Provider Name                     0
Address Line 1                    0
City/Town                         0
State                             0
ZIP Code                          0
County/Parish                     0
Telephone Number                  0
CMS Region                        0
Measure Code                      0
Score                             0
Footnote                          0
Start Date                        0
End Date                          0
Measure Date Range                0
LOCATION1                         0
dtype: int64
2025-02-13 00:11:57,471 - INFO - Number of Duplicate Rows: 0
2025-02-13 00:11:57,501 - INFO - Basic Stats for Numeric Columns:
2025-02-13 00:11:57,501 - INFO - ZIP Code     CMS Region
count  710016.000000  710016.000000
mean    50343.823486       5.190576
std     26875.286236       2.249510
min       660.000000       1.000000
25%     29732.000000       4.000000
50%     48519.000000       5.000000
75%     73045.750000       7.000000
max     99929.000000      10.000000
2025-02-13 00:11:57,501 - INFO - === Data Quality Checks for nh_survey ===
2025-02-13 00:11:57,513 - INFO - Missing Value Counts per Column:
2025-02-13 00:11:57,513 - INFO - CMS Certification Number (CCN)                                            0
Provider Name                                                             0
Provider Address                                                          0
City/Town                                                                 0
State                                                                     0
ZIP Code                                                                  0
Inspection Cycle                                                          0
Health Survey Date                                                        0
Fire Safety Survey Date                                                  33
Total Number of Health Deficiencies                                       0
Total Number of Fire Safety Deficiencies                                 33
Count of Freedom from Abuse and Neglect and Exploitation Deficiencies     0
Count of Quality of Life and Care Deficiencies                            0
Count of Resident Assessment and Care Planning Deficiencies               0
Count of Nursing and Physician Services Deficiencies                      0
Count of Resident Rights Deficiencies                                     0
Count of Nutrition and Dietary Deficiencies                               0
Count of Pharmacy Service Deficiencies                                    0
Count of Environmental Deficiencies                                       0
Count of Administration Deficiencies                                      0
Count of Infection Control Deficiencies                                   0
Count of Emergency Preparedness Deficiencies                             33
Count of Automatic Sprinkler Systems Deficiencies                        33
Count of Construction Deficiencies                                       33
Count of Services Deficiencies                                           33
Count of Corridor Walls and Doors Deficiencies                           33
Count of Egress Deficiencies                                             33
Count of Electrical Deficiencies                                         33
Count of Emergency Plans and Fire Drills Deficiencies                    33
Count of Fire Alarm Systems Deficiencies                                 33
Count of Smoke Deficiencies                                              33
Count of Interior Deficiencies                                           33
Count of Gas and Vacuum and Electrical Systems Deficiencies              33
Count of Hazardous Area Deficiencies                                     33
Count of Illumination and Emergency Power Deficiencies                   33
Count of Laboratories Deficiencies                                       33
Count of Medical Gases and Anaesthetizing Areas Deficiencies             33
Count of Smoking Regulations Deficiencies                                33
Count of Miscellaneous Deficiencies                                      33
Location                                                                  0
Processing Date                                                           0
dtype: int64
2025-02-13 00:11:57,557 - INFO - Number of Duplicate Rows: 0
2025-02-13 00:11:57,610 - INFO - Basic Stats for Numeric Columns:
2025-02-13 00:11:57,615 - INFO - ZIP Code  Inspection Cycle  Total Number of Health Deficiencies  \
count  44189.000000      44189.000000                         44189.000000   
mean   50339.324809          1.997013                             7.014710   
std    26891.348600          0.816399                             6.023656   
min      660.000000          1.000000                             0.000000   
25%    29720.000000          1.000000                             3.000000   
50%    48602.000000          2.000000                             6.000000   
75%    73049.000000          3.000000                            10.000000   
max    99929.000000          3.000000                            70.000000   

       Total Number of Fire Safety Deficiencies  \
count                              44156.000000   
mean                                   4.520405   
std                                    4.572814   
min                                    0.000000   
25%                                    1.000000   
50%                                    3.000000   
75%                                    7.000000   
max                                   44.000000   

       Count of Freedom from Abuse and Neglect and Exploitation Deficiencies  \
count                                       44189.000000                       
mean                                            0.283306                       
std                                             0.698449                       
min                                             0.000000                       
25%                                             0.000000                       
50%                                             0.000000                       
75%                                             0.000000                       
max                                             7.000000                       

       Count of Quality of Life and Care Deficiencies  \
count                                    44189.000000   
mean                                         1.755301   
std                                          1.912846   
min                                          0.000000   
25%                                          0.000000   
50%                                          1.000000   
75%                                          3.000000   
max                                         19.000000   

       Count of Resident Assessment and Care Planning Deficiencies  \
count                                       44189.000000             
mean                                            1.096359             
std                                             1.333293             
min                                             0.000000             
25%                                             0.000000             
50%                                             1.000000             
75%                                             2.000000             
max                                            11.000000             

       Count of Nursing and Physician Services Deficiencies  \
count                                       44189.000000      
mean                                            0.249270      
std                                             0.588568      
min                                             0.000000      
25%                                             0.000000      
50%                                             0.000000      
75%                                             0.000000      
max                                             8.000000      

       Count of Resident Rights Deficiencies  \
count                           44189.000000   
mean                                1.066442   
std                                 1.423154   
min                                 0.000000   
25%                                 0.000000   
50%                                 1.000000   
75%                                 2.000000   
max                                17.000000   

       Count of Nutrition and Dietary Deficiencies  ...  \
count                                 44189.000000  ...   
mean                                      0.732943  ...   
std                                       0.995185  ...   
min                                       0.000000  ...   
25%                                       0.000000  ...   
50%                                       0.000000  ...   
75%                                       1.000000  ...   
max                                      11.000000  ...   

       Count of Fire Alarm Systems Deficiencies  Count of Smoke Deficiencies  \
count                                   44156.0                 44156.000000   
mean                                        0.0                     1.759987   
std                                         0.0                     1.835830   
min                                         0.0                     0.000000   
25%                                         0.0                     0.000000   
50%                                         0.0                     1.000000   
75%                                         0.0                     3.000000   
max                                         0.0                    13.000000   

       Count of Interior Deficiencies  \
count                    44156.000000   
mean                         0.000045   
std                          0.006730   
min                          0.000000   
25%                          0.000000   
50%                          0.000000   
75%                          0.000000   
max                          1.000000   

       Count of Gas and Vacuum and Electrical Systems Deficiencies  \
count                                       44156.000000             
mean                                            0.814340             
std                                             1.050809             
min                                             0.000000             
25%                                             0.000000             
50%                                             0.000000             
75%                                             1.000000             
max                                             8.000000             

       Count of Hazardous Area Deficiencies  \
count                          44156.000000   
mean                               0.000023   
std                                0.004759   
min                                0.000000   
25%                                0.000000   
50%                                0.000000   
75%                                0.000000   
max                                1.000000   

       Count of Illumination and Emergency Power Deficiencies  \
count                                       44156.000000        
mean                                            0.000023        
std                                             0.004759        
min                                             0.000000        
25%                                             0.000000        
50%                                             0.000000        
75%                                             0.000000        
max                                             1.000000        

       Count of Laboratories Deficiencies  \
count                             44156.0   
mean                                  0.0   
std                                   0.0   
min                                   0.0   
25%                                   0.0   
50%                                   0.0   
75%                                   0.0   
max                                   0.0   

       Count of Medical Gases and Anaesthetizing Areas Deficiencies  \
count                                       44156.000000              
mean                                            0.000045              
std                                             0.006730              
min                                             0.000000              
25%                                             0.000000              
50%                                             0.000000              
75%                                             0.000000              
max                                             1.000000              

       Count of Smoking Regulations Deficiencies  \
count                                    44156.0   
mean                                         0.0   
std                                          0.0   
min                                          0.0   
25%                                          0.0   
50%                                          0.0   
75%                                          0.0   
max                                          0.0   

       Count of Miscellaneous Deficiencies  
count                         44156.000000  
mean                              0.466800  
std                               0.766179  
min                               0.000000  
25%                               0.000000  
50%                               0.000000  
75%                               1.000000  
max                               7.000000  

[8 rows x 32 columns]
2025-02-13 00:11:57,615 - INFO - === Data Quality Checks for nh_quality_mds ===
2025-02-13 00:11:57,685 - INFO - Missing Value Counts per Column:
2025-02-13 00:11:57,686 - INFO - CMS Certification Number (CCN)                   0
Provider Name                                    0
Provider Address                                 0
City/Town                                        0
State                                            0
ZIP Code                                         0
Measure Code                                     0
Measure Description                              0
Resident type                                    0
Q1 Measure Score                             64416
Footnote for Q1 Measure Score               187048
Q2 Measure Score                             30096
Footnote for Q2 Measure Score               221368
Q3 Measure Score                             29209
Footnote for Q3 Measure Score               222255
Q4 Measure Score                             28945
Footnote for Q4 Measure Score               222519
Four Quarter Average Score                    8775
Footnote for Four Quarter Average Score     242689
Used in Quality Measure Five Star Rating         0
Measure Period                                   0
Location                                         0
Processing Date                                  0
dtype: int64
2025-02-13 00:11:57,929 - INFO - Number of Duplicate Rows: 0
2025-02-13 00:11:58,057 - INFO - Basic Stats for Numeric Columns:
2025-02-13 00:11:58,060 - INFO - ZIP Code   Measure Code  Q1 Measure Score  \
count  251464.000000  251464.000000     187048.000000   
mean    50343.823486     431.235294         29.152946   
std     26875.320747      27.061051         38.566512   
min       660.000000     401.000000          0.000000   
25%     29732.000000     408.000000          0.964827   
50%     48519.000000     419.000000          6.583004   
75%     73045.750000     452.000000         64.814815   
max     99929.000000     480.000000        100.000000   

       Footnote for Q1 Measure Score  Q2 Measure Score  \
count                   64416.000000     221368.000000   
mean                        9.057004         28.301362   
std                         0.740011         36.190215   
min                         9.000000          0.000000   
25%                         9.000000          1.754386   
50%                         9.000000          9.677419   
75%                         9.000000         39.062500   
max                        21.000000        100.000000   

       Footnote for Q2 Measure Score  Q3 Measure Score  \
count                   30096.000000     222255.000000   
mean                        9.119717         28.010306   
std                         1.078166         36.341175   
min                         9.000000          0.000000   
25%                         9.000000          1.642325   
50%                         9.000000          9.090909   
75%                         9.000000         37.837838   
max                        21.000000        100.000000   

       Footnote for Q3 Measure Score  Q4 Measure Score  \
count                   29209.000000     222519.000000   
mean                        9.121504         27.763505   
std                         1.093571         36.364891   
min                         9.000000          0.000000   
25%                         9.000000          1.562500   
50%                         9.000000          8.695652   
75%                         9.000000         37.254902   
max                        21.000000        100.000000   

       Footnote for Q4 Measure Score  Four Quarter Average Score  \
count                   28945.000000               242689.000000   
mean                        9.111695                   27.987423   
std                         1.094674                   35.580175   
min                         9.000000                    0.000000   
25%                         9.000000                    2.020202   
50%                         9.000000                    9.864886   
75%                         9.000000                   36.609312   
max                        21.000000                  100.000000   

       Footnote for Four Quarter Average Score  
count                              8775.000000  
mean                                  9.358519  
std                                   1.963599  
min                                   9.000000  
25%                                   9.000000  
50%                                   9.000000  
75%                                   9.000000  
max                                  21.000000
2025-02-13 00:11:58,060 - INFO - === Data Quality Checks for nh_ownership ===
2025-02-13 00:11:58,103 - INFO - Missing Value Counts per Column:
2025-02-13 00:11:58,103 - INFO - CMS Certification Number (CCN)                   0
Provider Name                                    0
Provider Address                                 0
City/Town                                        0
State                                            0
ZIP Code                                         0
Role played by Owner or Manager in Facility      0
Owner Type                                     595
Owner Name                                     595
Ownership Percentage                           595
Association Date                               595
Location                                         0
Processing Date                                  0
dtype: int64
2025-02-13 00:11:58,218 - INFO - Number of Duplicate Rows: 0
2025-02-13 00:11:58,223 - INFO - Basic Stats for Numeric Columns:
2025-02-13 00:11:58,223 - INFO - ZIP Code
count  144651.000000
mean    49603.405237
std     26783.368229
min       660.000000
25%     28655.000000
50%     47532.000000
75%     71203.000000
max     99929.000000
2025-02-13 00:11:58,223 - INFO - === Data Quality Checks for nh_citations ===
2025-02-13 00:11:58,417 - INFO - Missing Value Counts per Column:
2025-02-13 00:11:58,417 - INFO - CMS Certification Number (CCN)                0
Provider Name                                 0
Provider Address                              0
City/Town                                     0
State                                         0
ZIP Code                                      0
Survey Date                                   0
Survey Type                                   0
Deficiency Prefix                             0
Deficiency Category                           0
Deficiency Tag Number                         0
Deficiency Description                        0
Scope Severity Code                           0
Deficiency Corrected                          0
Correction Date                            1392
Inspection Cycle                              0
Standard Deficiency                           0
Complaint Deficiency                          0
Infection Control Inspection Deficiency       0
Citation under IDR                            0
Citation under IIDR                           0
Location                                      0
Processing Date                               0
dtype: int64
2025-02-13 00:11:58,929 - INFO - Number of Duplicate Rows: 0
2025-02-13 00:11:58,959 - INFO - Basic Stats for Numeric Columns:
2025-02-13 00:11:58,960 - INFO - ZIP Code  Deficiency Tag Number  Inspection Cycle
count  406789.000000          406789.000000     406789.000000
mean    54492.822982             709.477156          1.958423
std     28369.178174             102.584999          0.812428
min       660.000000             151.000000          1.000000
25%     31040.000000             641.000000          1.000000
50%     55077.000000             689.000000          2.000000
75%     78052.000000             761.000000          3.000000
max     99929.000000             949.000000          3.000000
2025-02-13 00:11:58,960 - INFO - === Data Quality Checks Completed ===
2025-02-13 00:11:58,967 - INFO - === Starting Data Type Validation and Conversion ===
2025-02-13 00:11:58,968 - INFO - --- Evaluating pbj_nurse ---
2025-02-13 00:11:58,968 - INFO - Current Data Types:
2025-02-13 00:11:58,969 - INFO - PROVNUM              object
PROVNAME             object
CITY                 object
STATE                object
COUNTY_NAME          object
COUNTY_FIPS           int64
CY_Qtr               object
WorkDate              int64
MDScensus             int64
Hrs_RNDON           float64
Hrs_RNDON_emp       float64
Hrs_RNDON_ctr       float64
Hrs_RNadmin         float64
Hrs_RNadmin_emp     float64
Hrs_RNadmin_ctr     float64
Hrs_RN              float64
Hrs_RN_emp          float64
Hrs_RN_ctr          float64
Hrs_LPNadmin        float64
Hrs_LPNadmin_emp    float64
Hrs_LPNadmin_ctr    float64
Hrs_LPN             float64
Hrs_LPN_emp         float64
Hrs_LPN_ctr         float64
Hrs_CNA             float64
Hrs_CNA_emp         float64
Hrs_CNA_ctr         float64
Hrs_NAtrn           float64
Hrs_NAtrn_emp       float64
Hrs_NAtrn_ctr       float64
Hrs_MedAide         float64
Hrs_MedAide_emp     float64
Hrs_MedAide_ctr     float64
dtype: object
2025-02-13 00:11:59,333 - INFO - Converted 'WorkDate' to datetime for pbj_nurse
2025-02-13 00:11:59,333 - INFO - --- Evaluating pbj_non_nurse ---
2025-02-13 00:11:59,333 - INFO - Current Data Types:
2025-02-13 00:11:59,334 - INFO - PROVNUM               object
PROVNAME              object
CITY                  object
STATE                 object
COUNTY_NAME           object
                      ...   
Hrs_OthSocWrk_emp    float64
Hrs_OthSocWrk_ctr    float64
Hrs_MHSvc            float64
Hrs_MHSvc_emp        float64
Hrs_MHSvc_ctr        float64
Length: 82, dtype: object
2025-02-13 00:11:59,674 - INFO - Converted 'WorkDate' to datetime for pbj_non_nurse
2025-02-13 00:11:59,675 - INFO - --- Evaluating qrp_provider ---
2025-02-13 00:11:59,675 - INFO - Current Data Types:
2025-02-13 00:11:59,675 - INFO - CMS Certification Number (CCN)    object
Provider Name                     object
Address Line 1                    object
City/Town                         object
State                             object
ZIP Code                           int64
County/Parish                     object
Telephone Number                  object
CMS Region                         int64
Measure Code                      object
Score                             object
Footnote                          object
Start Date                        object
End Date                          object
Measure Date Range                object
LOCATION1                         object
dtype: object
2025-02-13 00:11:59,724 - INFO - Converted 'Start Date' to datetime for qrp_provider
2025-02-13 00:11:59,770 - INFO - Converted 'End Date' to datetime for qrp_provider
2025-02-13 00:11:59,771 - INFO - --- Evaluating nh_survey ---
2025-02-13 00:11:59,771 - INFO - Current Data Types:
2025-02-13 00:11:59,771 - INFO - CMS Certification Number (CCN)                                            object
Provider Name                                                             object
Provider Address                                                          object
City/Town                                                                 object
State                                                                     object
ZIP Code                                                                   int64
Inspection Cycle                                                           int64
Health Survey Date                                                        object
Fire Safety Survey Date                                                   object
Total Number of Health Deficiencies                                        int64
Total Number of Fire Safety Deficiencies                                 float64
Count of Freedom from Abuse and Neglect and Exploitation Deficiencies      int64
Count of Quality of Life and Care Deficiencies                             int64
Count of Resident Assessment and Care Planning Deficiencies                int64
Count of Nursing and Physician Services Deficiencies                       int64
Count of Resident Rights Deficiencies                                      int64
Count of Nutrition and Dietary Deficiencies                                int64
Count of Pharmacy Service Deficiencies                                     int64
Count of Environmental Deficiencies                                        int64
Count of Administration Deficiencies                                       int64
Count of Infection Control Deficiencies                                    int64
Count of Emergency Preparedness Deficiencies                             float64
Count of Automatic Sprinkler Systems Deficiencies                        float64
Count of Construction Deficiencies                                       float64
Count of Services Deficiencies                                           float64
Count of Corridor Walls and Doors Deficiencies                           float64
Count of Egress Deficiencies                                             float64
Count of Electrical Deficiencies                                         float64
Count of Emergency Plans and Fire Drills Deficiencies                    float64
Count of Fire Alarm Systems Deficiencies                                 float64
Count of Smoke Deficiencies                                              float64
Count of Interior Deficiencies                                           float64
Count of Gas and Vacuum and Electrical Systems Deficiencies              float64
Count of Hazardous Area Deficiencies                                     float64
Count of Illumination and Emergency Power Deficiencies                   float64
Count of Laboratories Deficiencies                                       float64
Count of Medical Gases and Anaesthetizing Areas Deficiencies             float64
Count of Smoking Regulations Deficiencies                                float64
Count of Miscellaneous Deficiencies                                      float64
Location                                                                  object
Processing Date                                                           object
dtype: object
2025-02-13 00:11:59,776 - INFO - Converted 'Health Survey Date' to datetime for nh_survey
2025-02-13 00:11:59,785 - INFO - Converted 'Fire Safety Survey Date' to datetime for nh_survey
2025-02-13 00:11:59,789 - INFO - Converted 'Processing Date' to datetime for nh_survey
2025-02-13 00:11:59,789 - INFO - --- Evaluating nh_quality_mds ---
2025-02-13 00:11:59,789 - INFO - Current Data Types:
2025-02-13 00:11:59,789 - INFO - CMS Certification Number (CCN)               object
Provider Name                                object
Provider Address                             object
City/Town                                    object
State                                        object
ZIP Code                                      int64
Measure Code                                  int64
Measure Description                          object
Resident type                                object
Q1 Measure Score                            float64
Footnote for Q1 Measure Score               float64
Q2 Measure Score                            float64
Footnote for Q2 Measure Score               float64
Q3 Measure Score                            float64
Footnote for Q3 Measure Score               float64
Q4 Measure Score                            float64
Footnote for Q4 Measure Score               float64
Four Quarter Average Score                  float64
Footnote for Four Quarter Average Score     float64
Used in Quality Measure Five Star Rating     object
Measure Period                               object
Location                                     object
Processing Date                              object
dtype: object
2025-02-13 00:11:59,808 - INFO - Converted 'Measure Period' to datetime for nh_quality_mds
2025-02-13 00:11:59,826 - INFO - Converted 'Processing Date' to datetime for nh_quality_mds
2025-02-13 00:11:59,826 - INFO - --- Evaluating nh_ownership ---
2025-02-13 00:11:59,826 - INFO - Current Data Types:
2025-02-13 00:11:59,826 - INFO - CMS Certification Number (CCN)                 object
Provider Name                                  object
Provider Address                               object
City/Town                                      object
State                                          object
ZIP Code                                        int64
Role played by Owner or Manager in Facility    object
Owner Type                                     object
Owner Name                                     object
Ownership Percentage                           object
Association Date                               object
Location                                       object
Processing Date                                object
dtype: object
2025-02-13 00:11:59,842 - INFO - Converted 'Association Date' to datetime for nh_ownership with format='%Y-%m-%d'
2025-02-13 00:11:59,852 - INFO - Converted 'Processing Date' to datetime for nh_ownership with format='%Y-%m-%d'
2025-02-13 00:11:59,852 - INFO - --- Evaluating nh_citations ---
2025-02-13 00:11:59,852 - INFO - Current Data Types:
2025-02-13 00:11:59,853 - INFO - CMS Certification Number (CCN)             object
Provider Name                              object
Provider Address                           object
City/Town                                  object
State                                      object
ZIP Code                                    int64
Survey Date                                object
Survey Type                                object
Deficiency Prefix                          object
Deficiency Category                        object
Deficiency Tag Number                       int64
Deficiency Description                     object
Scope Severity Code                        object
Deficiency Corrected                       object
Correction Date                            object
Inspection Cycle                            int64
Standard Deficiency                        object
Complaint Deficiency                       object
Infection Control Inspection Deficiency    object
Citation under IDR                         object
Citation under IIDR                        object
Location                                   object
Processing Date                            object
dtype: object
2025-02-13 00:11:59,883 - INFO - Converted 'Survey Date' to datetime for nh_citations
2025-02-13 00:11:59,908 - INFO - Converted 'Correction Date' to datetime for nh_citations
2025-02-13 00:11:59,936 - INFO - Converted 'Processing Date' to datetime for nh_citations
2025-02-13 00:11:59,936 - INFO - === Data Type Validation and Conversion Completed ===
2025-02-13 00:11:59,941 - INFO - === Starting Standardization & Basic Cleaning ===
2025-02-13 00:11:59,941 - INFO - --- Standardizing columns for pbj_nurse ---
2025-02-13 00:11:59,941 - INFO - New columns:
2025-02-13 00:11:59,942 - INFO - ['provnum', 'provname', 'city', 'state', 'county_name', 'county_fips', 'cy_qtr', 'workdate', 'mdscensus', 'hrs_rndon', 'hrs_rndon_emp', 'hrs_rndon_ctr', 'hrs_rnadmin', 'hrs_rnadmin_emp', 'hrs_rnadmin_ctr', 'hrs_rn', 'hrs_rn_emp', 'hrs_rn_ctr', 'hrs_lpnadmin', 'hrs_lpnadmin_emp', 'hrs_lpnadmin_ctr', 'hrs_lpn', 'hrs_lpn_emp', 'hrs_lpn_ctr', 'hrs_cna', 'hrs_cna_emp', 'hrs_cna_ctr', 'hrs_natrn', 'hrs_natrn_emp', 'hrs_natrn_ctr', 'hrs_medaide', 'hrs_medaide_emp', 'hrs_medaide_ctr']
2025-02-13 00:11:59,942 - INFO - --- Standardizing columns for pbj_non_nurse ---
2025-02-13 00:11:59,942 - INFO - New columns:
2025-02-13 00:11:59,942 - INFO - ['provnum', 'provname', 'city', 'state', 'county_name', 'county_fips', 'cy_qtr', 'workdate', 'mdscensus', 'hrs_admin', 'hrs_admin_emp', 'hrs_admin_ctr', 'hrs_admin_fn', 'hrs_meddir', 'hrs_meddir_emp', 'hrs_meddir_ctr', 'hrs_othmd', 'hrs_othmd_emp', 'hrs_othmd_ctr', 'hrs_pa', 'hrs_pa_emp', 'hrs_pa_ctr', 'hrs_np', 'hrs_np_emp', 'hrs_np_ctr', 'hrs_clinnrsspec', 'hrs_clinnrsspec_emp', 'hrs_clinnrsspec_ctr', 'hrs_pharmacist', 'hrs_pharmacist_emp', 'hrs_pharmacist_ctr', 'hrs_dietician', 'hrs_dietician_emp', 'hrs_dietician_ctr', 'hrs_feedasst', 'hrs_feedasst_emp', 'hrs_feedasst_ctr', 'hrs_ot', 'hrs_ot_emp', 'hrs_ot_ctr', 'hrs_otasst', 'hrs_otasst_emp', 'hrs_otasst_ctr', 'hrs_otaide', 'hrs_otaide_emp', 'hrs_otaide_ctr', 'hrs_pt', 'hrs_pt_emp', 'hrs_pt_ctr', 'hrs_ptasst', 'hrs_ptasst_emp', 'hrs_ptasst_ctr', 'hrs_ptaide', 'hrs_ptaide_emp', 'hrs_ptaide_ctr', 'hrs_respther', 'hrs_respther_emp', 'hrs_respther_ctr', 'hrs_resptech', 'hrs_resptech_emp', 'hrs_resptech_ctr', 'hrs_spclangpath', 'hrs_spclangpath_emp', 'hrs_spclangpath_ctr', 'hrs_therrecspec', 'hrs_therrecspec_emp', 'hrs_therrecspec_ctr', 'hrs_qualactvprof', 'hrs_qualactvprof_emp', 'hrs_qualactvprof_ctr', 'hrs_othactv', 'hrs_othactv_emp', 'hrs_othactv_ctr', 'hrs_qualsocwrk', 'hrs_qualsocwrk_emp', 'hrs_qualsocwrk_ctr', 'hrs_othsocwrk', 'hrs_othsocwrk_emp', 'hrs_othsocwrk_ctr', 'hrs_mhsvc', 'hrs_mhsvc_emp', 'hrs_mhsvc_ctr']
2025-02-13 00:11:59,942 - INFO - --- Standardizing columns for qrp_provider ---
2025-02-13 00:11:59,942 - INFO - New columns:
2025-02-13 00:11:59,942 - INFO - ['cms_certification_number_(ccn)', 'provider_name', 'address_line_1', 'city/town', 'state', 'zip_code', 'county/parish', 'telephone_number', 'cms_region', 'measure_code', 'score', 'footnote', 'start_date', 'end_date', 'measure_date_range', 'location1']
2025-02-13 00:11:59,942 - INFO - --- Standardizing columns for nh_survey ---
2025-02-13 00:11:59,942 - INFO - New columns:
2025-02-13 00:11:59,942 - INFO - ['cms_certification_number_(ccn)', 'provider_name', 'provider_address', 'city/town', 'state', 'zip_code', 'inspection_cycle', 'health_survey_date', 'fire_safety_survey_date', 'total_number_of_health_deficiencies', 'total_number_of_fire_safety_deficiencies', 'count_of_freedom_from_abuse_and_neglect_and_exploitation_deficiencies', 'count_of_quality_of_life_and_care_deficiencies', 'count_of_resident_assessment_and_care_planning_deficiencies', 'count_of_nursing_and_physician_services_deficiencies', 'count_of_resident_rights_deficiencies', 'count_of_nutrition_and_dietary_deficiencies', 'count_of_pharmacy_service_deficiencies', 'count_of_environmental_deficiencies', 'count_of_administration_deficiencies', 'count_of_infection_control_deficiencies', 'count_of_emergency_preparedness_deficiencies', 'count_of_automatic_sprinkler_systems_deficiencies', 'count_of_construction_deficiencies', 'count_of_services_deficiencies', 'count_of_corridor_walls_and_doors_deficiencies', 'count_of_egress_deficiencies', 'count_of_electrical_deficiencies', 'count_of_emergency_plans_and_fire_drills_deficiencies', 'count_of_fire_alarm_systems_deficiencies', 'count_of_smoke_deficiencies', 'count_of_interior_deficiencies', 'count_of_gas_and_vacuum_and_electrical_systems_deficiencies', 'count_of_hazardous_area_deficiencies', 'count_of_illumination_and_emergency_power_deficiencies', 'count_of_laboratories_deficiencies', 'count_of_medical_gases_and_anaesthetizing_areas_deficiencies', 'count_of_smoking_regulations_deficiencies', 'count_of_miscellaneous_deficiencies', 'location', 'processing_date']
2025-02-13 00:11:59,942 - INFO - --- Standardizing columns for nh_quality_mds ---
2025-02-13 00:11:59,943 - INFO - New columns:
2025-02-13 00:11:59,943 - INFO - ['cms_certification_number_(ccn)', 'provider_name', 'provider_address', 'city/town', 'state', 'zip_code', 'measure_code', 'measure_description', 'resident_type', 'q1_measure_score', 'footnote_for_q1_measure_score', 'q2_measure_score', 'footnote_for_q2_measure_score', 'q3_measure_score', 'footnote_for_q3_measure_score', 'q4_measure_score', 'footnote_for_q4_measure_score', 'four_quarter_average_score', 'footnote_for_four_quarter_average_score', 'used_in_quality_measure_five_star_rating', 'measure_period', 'location', 'processing_date']
2025-02-13 00:11:59,943 - INFO - --- Standardizing columns for nh_ownership ---
2025-02-13 00:11:59,943 - INFO - New columns:
2025-02-13 00:11:59,943 - INFO - ['cms_certification_number_(ccn)', 'provider_name', 'provider_address', 'city/town', 'state', 'zip_code', 'role_played_by_owner_or_manager_in_facility', 'owner_type', 'owner_name', 'ownership_percentage', 'association_date', 'location', 'processing_date']
2025-02-13 00:11:59,943 - INFO - --- Standardizing columns for nh_citations ---
2025-02-13 00:11:59,943 - INFO - New columns:
2025-02-13 00:11:59,943 - INFO - ['cms_certification_number_(ccn)', 'provider_name', 'provider_address', 'city/town', 'state', 'zip_code', 'survey_date', 'survey_type', 'deficiency_prefix', 'deficiency_category', 'deficiency_tag_number', 'deficiency_description', 'scope_severity_code', 'deficiency_corrected', 'correction_date', 'inspection_cycle', 'standard_deficiency', 'complaint_deficiency', 'infection_control_inspection_deficiency', 'citation_under_idr', 'citation_under_iidr', 'location', 'processing_date']
2025-02-13 00:11:59,943 - INFO - === Standardization & Basic Cleaning Completed ===
2025-02-13 00:11:59,949 - INFO - === Saving Final Prepared Datasets ===
2025-02-13 00:12:01,287 - INFO - Saved pbj_nurse to ./data/prepared/pbj_nurse_prepared.parquet
2025-02-13 00:12:03,509 - INFO - Saved pbj_non_nurse to ./data/prepared/pbj_non_nurse_prepared.parquet
2025-02-13 00:12:04,290 - INFO - Saved qrp_provider to ./data/prepared/qrp_provider_prepared.parquet
2025-02-13 00:12:04,358 - INFO - Saved nh_survey to ./data/prepared/nh_survey_prepared.parquet
2025-02-13 00:12:04,650 - INFO - Saved nh_quality_mds to ./data/prepared/nh_quality_mds_prepared.parquet
2025-02-13 00:12:04,805 - INFO - Saved nh_ownership to ./data/prepared/nh_ownership_prepared.parquet
2025-02-13 00:12:05,449 - INFO - Saved nh_citations to ./data/prepared/nh_citations_prepared.parquet
2025-02-13 00:12:05,450 - INFO - === Final Save Completed. Datasets are now ready for analysis. ===
2025-02-13 00:12:11,423 - INFO - [{"variableName": "datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "describe_df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "loaded_datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "missing_counts", "type": "series", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.series.Series"}, {"variableName": "new_columns", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}]
2025-02-13 00:12:13,194 - INFO - [{"variableName": "datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "describe_df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "loaded_datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "missing_counts", "type": "series", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.series.Series"}, {"variableName": "new_columns", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}]
2025-02-13 00:13:25,531 - INFO - [{"variableName": "datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "describe_df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "loaded_datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "missing_counts", "type": "series", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.series.Series"}, {"variableName": "new_columns", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}]
2025-02-13 00:13:26,669 - INFO - [{"variableName": "datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "describe_df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "df", "type": "pandas", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.frame.DataFrame"}, {"variableName": "loaded_datasets", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}, {"variableName": "missing_counts", "type": "series", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "pandas.core.series.Series"}, {"variableName": "new_columns", "type": "dictionary", "supportedEngines": ["pandas"], "isLocalVariable": false, "rawType": "builtins.dict"}]
2025-02-13 00:13:34,363 - INFO - {"type": "pandas", "supportedEngines": ["pandas"], "rawType": "pandas.core.frame.DataFrame"}
