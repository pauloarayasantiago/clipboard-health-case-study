2025-02-13 12:01:37,602 - INFO - === Starting Process Phase Notebook: Logging Setup Complete ===
2025-02-13 12:01:37,945 - INFO - Loaded pbj_nurse with shape (1325324, 33)
2025-02-13 12:01:38,302 - INFO - Loaded pbj_non_nurse with shape (1325324, 82)
2025-02-13 12:01:38,623 - INFO - Loaded qrp_provider with shape (710016, 16)
2025-02-13 12:01:38,650 - INFO - Loaded nh_survey with shape (44189, 41)
2025-02-13 12:01:38,755 - INFO - Loaded nh_quality_mds with shape (251464, 23)
2025-02-13 12:01:38,835 - INFO - Loaded nh_ownership with shape (144651, 13)
2025-02-13 12:01:39,102 - INFO - Loaded nh_citations with shape (406789, 23)
2025-02-13 12:01:39,102 - INFO - Columns in pbj_nurse:
2025-02-13 12:01:39,102 - INFO - ['provnum', 'provname', 'city', 'state', 'county_name', 'county_fips', 'cy_qtr', 'workdate', 'mdscensus', 'hrs_rndon', 'hrs_rndon_emp', 'hrs_rndon_ctr', 'hrs_rnadmin', 'hrs_rnadmin_emp', 'hrs_rnadmin_ctr', 'hrs_rn', 'hrs_rn_emp', 'hrs_rn_ctr', 'hrs_lpnadmin', 'hrs_lpnadmin_emp', 'hrs_lpnadmin_ctr', 'hrs_lpn', 'hrs_lpn_emp', 'hrs_lpn_ctr', 'hrs_cna', 'hrs_cna_emp', 'hrs_cna_ctr', 'hrs_natrn', 'hrs_natrn_emp', 'hrs_natrn_ctr', 'hrs_medaide', 'hrs_medaide_emp', 'hrs_medaide_ctr']
2025-02-13 12:01:39,191 - INFO - Calculated 'rn_temp_ratio' for PBJ Nurse dataset.
2025-02-13 12:01:39,204 - INFO - hrs_rn_emp  hrs_rn_ctr  rn_temp_ratio
0       55.70         0.0            0.0
1       63.28         0.0            0.0
2       76.29         0.0            0.0
3       54.13         0.0            0.0
4       53.63         0.0            0.0
2025-02-13 12:01:39,243 - INFO - === BASIC HISTOGRAMS & VISUALIZATIONS ===
2025-02-13 12:01:40,756 - INFO - === EXTREME OUTLIER ANALYSIS FOR RN STAFFING VARIABLES ===
2025-02-13 12:01:40,773 - INFO - Summary percentiles for hrs_rn_emp: [  0.    12.08  24.42  42.    65.89  86.   148.14 887.96]
2025-02-13 12:01:40,776 - INFO - Number of extreme outliers for hrs_rn_emp (above 99th percentile = 148.14): 13253
2025-02-13 12:01:40,788 - INFO - Summary percentiles for hrs_rn_ctr: [  0.       0.       0.       0.       8.75    16.4     43.6377 512.39  ]
2025-02-13 12:01:40,789 - INFO - Number of extreme outliers for hrs_rn_ctr (above 99th percentile = 43.63770000000019): 13254
2025-02-13 12:01:40,800 - INFO - Summary percentiles for rn_temp_ratio: [0.         0.         0.         0.         0.25212471 0.49077882
 0.99999992 1.        ]
2025-02-13 12:01:40,802 - INFO - Number of extreme outliers for rn_temp_ratio (above 99th percentile = 0.9999999152542446): 13210
2025-02-13 12:01:41,780 - INFO - === IN-DEPTH ANALYSIS (Outliers, Facility-Level, Correlation, Time-Series) ===
2025-02-13 12:01:41,814 - INFO - Variable: hrs_rn_emp
  99th percentile: 148.14
  # of outliers > 99th percentile: 13253
2025-02-13 12:01:41,824 - INFO - Variable: hrs_rn_ctr
  99th percentile: 43.64
  # of outliers > 99th percentile: 13254
2025-02-13 12:01:41,835 - INFO - Variable: rn_temp_ratio
  99th percentile: 1.00
  # of outliers > 99th percentile: 13210
2025-02-13 12:01:41,835 - INFO - === EDA (Histograms & Boxplots) ===
2025-02-13 12:01:42,448 - ERROR - c:\Users\paulo\OneDrive\TRABALHO\Clipboard Health\clipboard_health_env\Lib\site-packages\pandas\core\nanops.py:1016: RuntimeWarning: invalid value encountered in subtract
  sqr = _ensure_numeric((avg - values) ** 2)
2025-02-13 12:01:43,408 - ERROR - c:\Users\paulo\OneDrive\TRABALHO\Clipboard Health\clipboard_health_env\Lib\site-packages\pandas\core\nanops.py:1016: RuntimeWarning: invalid value encountered in subtract
  sqr = _ensure_numeric((avg - values) ** 2)
2025-02-13 12:01:55,045 - INFO - === Facility-Level Analysis ===
2025-02-13 12:01:55,124 - INFO - Top 10 Facilities by Average RN Temporary Staffing Ratio:
2025-02-13 12:01:55,126 - INFO - provnum  avg_rn_temp_ratio  total_rn_ctr  total_rn_emp
2205  105910           1.000000      16812.00           0.0
8359  335436           1.000000       7514.00           0.0
2236  105982           1.000000       3856.21           0.0
2579  115551           1.000000       3971.78           0.0
2530  115482           1.000000       3054.75           0.0
2591  115565           1.000000       2847.30           0.0
8093  32E027           1.000000       2511.54           0.0
7566  295048           1.000000       2379.06           0.0
7935  315396           1.000000       2359.79           0.0
8501  335628           0.998215       5766.50           8.0
2025-02-13 12:01:55,127 - INFO - Top 10 Facilities by Total RN Contract Hours:
2025-02-13 12:01:55,128 - INFO - provnum  avg_rn_temp_ratio  total_rn_ctr  total_rn_emp
8208  335227           0.793188      30647.31       7892.02
8377  335462           0.764099      24882.25       8044.00
8350  335426           0.951306      24099.00       1169.75
8664  335838           0.740793      21272.99       7819.00
2205  105910           1.000000      16812.00          0.00
8621  335791           0.730992      14970.25       5348.50
8191  335199           0.847394      14771.08       2776.38
8404  335495           0.673210      14396.70       7017.17
8143  335100           0.444069      14317.38      18002.23
8498  335625           0.650298      12056.07       6545.02
2025-02-13 12:01:55,128 - INFO - === Correlation with LPN, CNA, etc. ===
2025-02-13 12:01:55,296 - INFO - Correlation Matrix:
2025-02-13 12:01:55,298 - INFO - hrs_rn_emp  hrs_rn_ctr  rn_temp_ratio  hrs_lpn_emp  \
hrs_rn_emp       1.000000    0.142540      -0.111049     0.283579   
hrs_rn_ctr       0.142540    1.000000       0.617574     0.003641   
rn_temp_ratio   -0.111049    0.617574       1.000000    -0.093981   
hrs_lpn_emp      0.283579    0.003641      -0.093981     1.000000   
hrs_lpn_ctr      0.042317    0.257134       0.234507     0.031118   
hrs_cna_emp      0.587419    0.184973      -0.030125     0.716310   
hrs_cna_ctr      0.116939    0.424537       0.303364     0.065804   

               hrs_lpn_ctr  hrs_cna_emp  hrs_cna_ctr  
hrs_rn_emp        0.042317     0.587419     0.116939  
hrs_rn_ctr        0.257134     0.184973     0.424537  
rn_temp_ratio     0.234507    -0.030125     0.303364  
hrs_lpn_emp       0.031118     0.716310     0.065804  
hrs_lpn_ctr       1.000000     0.134436     0.480214  
hrs_cna_emp       0.134436     1.000000     0.080876  
hrs_cna_ctr       0.480214     0.080876     1.000000
2025-02-13 12:01:55,457 - INFO - === Advanced Outlier Profiling ===
2025-02-13 12:01:55,477 - INFO - Total outlier rows (top 1% by any metric): 36997
2025-02-13 12:01:55,483 - INFO - Outlier Facilities by State (Count & Avg RN Temp Ratio):
2025-02-13 12:01:55,484 - INFO - count  avg_rn_ratio
state                     
NY      9196      0.333048
IL      3056      0.528114
PA      2607      0.586672
FL      2173      0.143858
MN      1704      0.559392
CA      1302      0.216867
NJ      1272      0.458718
MA      1054      0.813153
MD      1029      0.452005
OH      1009      0.859225
2025-02-13 12:01:55,484 - INFO - === TIME-SERIES ANALYSIS ===
2025-02-13 12:01:55,629 - INFO - Monthly Trends (Mean):
2025-02-13 12:01:55,630 - INFO - year_month  hrs_rn_emp  hrs_rn_ctr  rn_temp_ratio
0    2024-04   32.091809    2.847699       0.064954
1    2024-05   32.046815    2.818850       0.065227
2    2024-06   31.830180    2.768279       0.065278
2025-02-13 12:01:55,755 - INFO - Weekly Trends (Mean):
2025-02-13 12:01:55,756 - INFO - year_week  hrs_rn_emp  hrs_rn_ctr  rn_temp_ratio
0  2024-04-01/2024-04-07   31.813095    2.864946       0.065869
1  2024-04-08/2024-04-14   31.936866    2.852839       0.065360
2  2024-04-15/2024-04-21   32.092854    2.836626       0.064871
3  2024-04-22/2024-04-28   32.099654    2.859693       0.064970
4  2024-04-29/2024-05-05   32.093914    2.822752       0.065393
2025-02-13 12:01:55,761 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-02-13 12:01:55,762 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-02-13 12:01:55,762 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-02-13 12:01:55,763 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-02-13 12:01:55,763 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-02-13 12:01:55,763 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-02-13 12:01:55,890 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-02-13 12:01:55,891 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-02-13 12:01:55,892 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-02-13 12:01:55,893 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-02-13 12:01:55,894 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-02-13 12:01:55,896 - INFO - Using categorical units to plot a list of strings that are all parsable as floats or dates. If these strings should be plotted as numbers, cast to the appropriate data type before plotting.
2025-02-13 12:01:56,031 - INFO - === ANALYSIS COMPLETE ===
